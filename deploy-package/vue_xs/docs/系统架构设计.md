# ğŸ—ï¸ ç³»ç»Ÿæ¶æ„è®¾è®¡

**é¡¹ç›®ï¼š** MOMOç‚’é¥­åº—å°è¯´ç½‘ç«™ V2.0  
**æ¶æ„å¸ˆï¼š** å·¥ç¨‹å¸ˆA  
**è®¾è®¡æ—¥æœŸï¼š** 2025-10-27  
**ç‰ˆæœ¬ï¼š** v1.0

---

## ğŸ“‹ ç›®å½•

1. [æ¶æ„æ¦‚è§ˆ](#æ¶æ„æ¦‚è§ˆ)
2. [æŠ€æœ¯æ ˆ](#æŠ€æœ¯æ ˆ)
3. [ç³»ç»Ÿåˆ†å±‚](#ç³»ç»Ÿåˆ†å±‚)
4. [æ•°æ®åº“è®¾è®¡](#æ•°æ®åº“è®¾è®¡)
5. [æ¥å£è®¾è®¡](#æ¥å£è®¾è®¡)
6. [å®‰å…¨æ¶æ„](#å®‰å…¨æ¶æ„)
7. [æ€§èƒ½ä¼˜åŒ–](#æ€§èƒ½ä¼˜åŒ–)
8. [éƒ¨ç½²æ¶æ„](#éƒ¨ç½²æ¶æ„)

---

## ğŸ¯ æ¶æ„æ¦‚è§ˆ

### æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ç”¨æˆ·æµè§ˆå™¨                           â”‚
â”‚                 (Chrome/Safari/Firefox)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚ HTTPS
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Nginxåå‘ä»£ç†                        â”‚
â”‚                  (è´Ÿè½½å‡è¡¡ + SSLç»ˆç»“)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                                  â”‚
         â”‚ é™æ€èµ„æº                          â”‚ APIè¯·æ±‚
         â–¼                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å‰ç«¯åº”ç”¨         â”‚              â”‚     åç«¯APIæœåŠ¡       â”‚
â”‚   Vue 3 + Vite   â”‚              â”‚  Fastify + Node.js   â”‚
â”‚   Port: 5188     â”‚              â”‚     Port: 3000       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                             â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                        â”‚              â”‚
                    â–¼                        â–¼              â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚   MySQL 8.0      â”‚    â”‚   Redis 7.0  â”‚  â”‚  æ–‡ä»¶å­˜å‚¨   â”‚
          â”‚   (ä¸»æ•°æ®åº“)      â”‚    â”‚   (ç¼“å­˜)     â”‚  â”‚  (æœ¬åœ°/OSS) â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### æ ¸å¿ƒè®¾è®¡åŸåˆ™

```
1. ğŸ”„ å‰åç«¯åˆ†ç¦»
   - å‰ç«¯ï¼šVue 3 SPA
   - åç«¯ï¼šRESTful API
   - é€šä¿¡ï¼šJSONæ ¼å¼

2. ğŸ“¦ æ¨¡å—åŒ–è®¾è®¡
   - æŒ‰åŠŸèƒ½æ¨¡å—åˆ’åˆ†
   - ä½è€¦åˆï¼Œé«˜å†…èš
   - æ˜“äºç»´æŠ¤å’Œæ‰©å±•

3. ğŸ”’ å®‰å…¨ç¬¬ä¸€
   - JWTèº«ä»½è®¤è¯
   - æ•°æ®åŠ å¯†ä¼ è¾“
   - è¾“å…¥éªŒè¯
   - SQLæ³¨å…¥é˜²æŠ¤

4. âš¡ æ€§èƒ½ä¼˜åŒ–
   - Redisç¼“å­˜
   - æ•°æ®åº“ç´¢å¼•
   - CDNåŠ é€Ÿ
   - æ‡’åŠ è½½

5. ğŸ“ˆ å¯æ‰©å±•æ€§
   - å¾®æœåŠ¡é¢„ç•™
   - æ°´å¹³æ‰©å±•æ”¯æŒ
   - æ•°æ®åº“åˆ†åº“åˆ†è¡¨å‡†å¤‡
```

---

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### å‰ç«¯æŠ€æœ¯æ ˆ

```yaml
æ ¸å¿ƒæ¡†æ¶:
  - Vue 3.4+          # æ¸è¿›å¼æ¡†æ¶
  - TypeScript 5.3+   # ç±»å‹å®‰å…¨

æ„å»ºå·¥å…·:
  - Vite 5.0+         # å¿«é€Ÿæ„å»º

UIæ¡†æ¶:
  - Element Plus      # ç»„ä»¶åº“
  - Tailwind CSS 3.4+ # åŸå­åŒ–CSS

çŠ¶æ€ç®¡ç†:
  - Pinia 2.1+        # è½»é‡çŠ¶æ€ç®¡ç†

è·¯ç”±:
  - Vue Router 4.2+   # å®˜æ–¹è·¯ç”±

å·¥å…·åº“:
  - Axios             # HTTPå®¢æˆ·ç«¯
  - VueUse            # ç»„åˆå¼å·¥å…·åº“
  - DayJS             # æ—¥æœŸå¤„ç†
  - DOMPurify         # XSSé˜²æŠ¤
```

---

### åç«¯æŠ€æœ¯æ ˆ

```yaml
æ ¸å¿ƒæ¡†æ¶:
  - Node.js 18+       # è¿è¡Œæ—¶
  - Fastify 4.25+     # Webæ¡†æ¶
  - TypeScript 5.3+   # ç±»å‹å®‰å…¨

æ•°æ®åº“:
  - MySQL 8.0         # å…³ç³»æ•°æ®åº“
  - Prisma 5.9+       # ORM
  - Redis 7.0         # ç¼“å­˜

è®¤è¯:
  - JWT               # Tokenè®¤è¯
  - bcrypt            # å¯†ç åŠ å¯†

å·¥å…·åº“:
  - Zod               # æ•°æ®éªŒè¯
  - DayJS             # æ—¥æœŸå¤„ç†
  - dotenv            # ç¯å¢ƒå˜é‡
```

---

### å¼€å‘å·¥å…·

```yaml
ç‰ˆæœ¬æ§åˆ¶:
  - Git               # ç‰ˆæœ¬ç®¡ç†
  - GitHub/Gitee      # ä»£ç æ‰˜ç®¡

å¼€å‘ç¯å¢ƒ:
  - VS Code           # IDE
  - Prisma Studio     # æ•°æ®åº“ç®¡ç†

æµ‹è¯•:
  - Vitest            # å•å…ƒæµ‹è¯•
  - Playwright        # E2Eæµ‹è¯•

ä»£ç è´¨é‡:
  - ESLint            # ä»£ç æ£€æŸ¥
  - Prettier          # ä»£ç æ ¼å¼åŒ–
  - TypeScript        # ç±»å‹æ£€æŸ¥
```

---

## ğŸ“š ç³»ç»Ÿåˆ†å±‚

### å‰ç«¯åˆ†å±‚æ¶æ„

```
frontend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ views/              # é¡µé¢è§†å›¾å±‚
â”‚   â”‚   â”œâ”€â”€ Home.vue
â”‚   â”‚   â”œâ”€â”€ Novel/
â”‚   â”‚   â”‚   â”œâ”€â”€ List.vue
â”‚   â”‚   â”‚   â”œâ”€â”€ Detail.vue
â”‚   â”‚   â”‚   â””â”€â”€ Edit.vue
â”‚   â”‚   â””â”€â”€ User/
â”‚   â”‚       â”œâ”€â”€ Profile.vue
â”‚   â”‚       â””â”€â”€ Settings.vue
â”‚   â”‚
â”‚   â”œâ”€â”€ components/         # ç»„ä»¶å±‚
â”‚   â”‚   â”œâ”€â”€ common/         # å…¬å…±ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ Button.vue
â”‚   â”‚   â”‚   â”œâ”€â”€ Input.vue
â”‚   â”‚   â”‚   â””â”€â”€ Modal.vue
â”‚   â”‚   â””â”€â”€ business/       # ä¸šåŠ¡ç»„ä»¶
â”‚   â”‚       â”œâ”€â”€ NovelCard.vue
â”‚   â”‚       â”œâ”€â”€ CommentList.vue
â”‚   â”‚       â””â”€â”€ UserAvatar.vue
â”‚   â”‚
â”‚   â”œâ”€â”€ composables/        # ç»„åˆå¼å‡½æ•°ï¼ˆä¸šåŠ¡é€»è¾‘ï¼‰
â”‚   â”‚   â”œâ”€â”€ useAuth.ts
â”‚   â”‚   â”œâ”€â”€ useNovel.ts
â”‚   â”‚   â””â”€â”€ useComment.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ stores/             # çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ auth.ts
â”‚   â”‚   â”œâ”€â”€ novel.ts
â”‚   â”‚   â””â”€â”€ user.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ api/                # APIæ¥å£å±‚
â”‚   â”‚   â”œâ”€â”€ auth.ts
â”‚   â”‚   â”œâ”€â”€ novel.ts
â”‚   â”‚   â””â”€â”€ user.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ utils/              # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ request.ts      # è¯·æ±‚å°è£…
â”‚   â”‚   â”œâ”€â”€ format.ts       # æ ¼å¼åŒ–
â”‚   â”‚   â””â”€â”€ validate.ts     # éªŒè¯
â”‚   â”‚
â”‚   â”œâ”€â”€ types/              # TypeScriptç±»å‹
â”‚   â”‚   â”œâ”€â”€ api.d.ts
â”‚   â”‚   â”œâ”€â”€ novel.d.ts
â”‚   â”‚   â””â”€â”€ user.d.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ router/             # è·¯ç”±é…ç½®
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚
â”‚   â””â”€â”€ assets/             # é™æ€èµ„æº
â”‚       â”œâ”€â”€ styles/
â”‚       â””â”€â”€ images/
```

---

### åç«¯åˆ†å±‚æ¶æ„

```
backend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ routes/             # è·¯ç”±å±‚ï¼ˆURLæ˜ å°„ï¼‰
â”‚   â”‚   â”œâ”€â”€ auth.routes.ts
â”‚   â”‚   â”œâ”€â”€ novel.routes.ts
â”‚   â”‚   â””â”€â”€ user.routes.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ controllers/        # æ§åˆ¶å™¨å±‚ï¼ˆè¯·æ±‚å¤„ç†ï¼‰
â”‚   â”‚   â”œâ”€â”€ auth.controller.ts
â”‚   â”‚   â”œâ”€â”€ novel.controller.ts
â”‚   â”‚   â””â”€â”€ user.controller.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ services/           # æœåŠ¡å±‚ï¼ˆä¸šåŠ¡é€»è¾‘ï¼‰
â”‚   â”‚   â”œâ”€â”€ auth.service.ts
â”‚   â”‚   â”œâ”€â”€ novel.service.ts
â”‚   â”‚   â””â”€â”€ user.service.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ repositories/       # æ•°æ®è®¿é—®å±‚ï¼ˆå¯é€‰ï¼‰
â”‚   â”‚   â”œâ”€â”€ novel.repository.ts
â”‚   â”‚   â””â”€â”€ user.repository.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ middlewares/        # ä¸­é—´ä»¶
â”‚   â”‚   â”œâ”€â”€ auth.middleware.ts
â”‚   â”‚   â”œâ”€â”€ error.middleware.ts
â”‚   â”‚   â””â”€â”€ logger.middleware.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ utils/              # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ jwt.ts
â”‚   â”‚   â”œâ”€â”€ password.ts
â”‚   â”‚   â””â”€â”€ validator.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ types/              # TypeScriptç±»å‹
â”‚   â”‚   â”œâ”€â”€ api.d.ts
â”‚   â”‚   â””â”€â”€ models.d.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ config/             # é…ç½®æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ database.ts
â”‚   â”‚   â””â”€â”€ redis.ts
â”‚   â”‚
â”‚   â””â”€â”€ server.ts           # å…¥å£æ–‡ä»¶
â”‚
â”œâ”€â”€ prisma/
â”‚   â””â”€â”€ schema.prisma       # æ•°æ®åº“æ¨¡å‹
â”‚
â””â”€â”€ tests/                  # æµ‹è¯•æ–‡ä»¶
    â”œâ”€â”€ unit/
    â””â”€â”€ integration/
```

---

### è¯·æ±‚å¤„ç†æµç¨‹

```
1. ç”¨æˆ·è¯·æ±‚
   â†“
2. Nginxæ¥æ”¶ï¼ˆåå‘ä»£ç†ï¼‰
   â†“
3. è·¯ç”±å±‚ï¼ˆRoutesï¼‰åŒ¹é…è·¯ç”±
   â†“
4. ä¸­é—´ä»¶å±‚ï¼ˆMiddlewaresï¼‰
   - æ—¥å¿—è®°å½•
   - èº«ä»½è®¤è¯
   - æƒé™æ£€æŸ¥
   â†“
5. æ§åˆ¶å™¨å±‚ï¼ˆControllersï¼‰å¤„ç†è¯·æ±‚
   - å‚æ•°éªŒè¯
   - è°ƒç”¨æœåŠ¡å±‚
   â†“
6. æœåŠ¡å±‚ï¼ˆServicesï¼‰ä¸šåŠ¡é€»è¾‘
   - æ•°æ®å¤„ç†
   - ç¼“å­˜æŸ¥è¯¢
   - æ•°æ®åº“æ“ä½œ
   â†“
7. æ•°æ®åº“å±‚ï¼ˆPrisma + MySQLï¼‰
   â†“
8. è¿”å›å“åº”
   â†“
9. ç”¨æˆ·æ¥æ”¶
```

---

## ğŸ—„ï¸ æ•°æ®åº“è®¾è®¡

### ERå›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    User     â”‚         â”‚    Novel     â”‚         â”‚   Comment   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id          â”‚â”€â”€â”€â”€â”    â”‚ id           â”‚â”€â”€â”€â”€â”    â”‚ id          â”‚
â”‚ username    â”‚    â”‚    â”‚ title        â”‚    â”‚    â”‚ content     â”‚
â”‚ email       â”‚    â”‚    â”‚ summary      â”‚    â”‚    â”‚ novelId     â”‚â”€â”
â”‚ password    â”‚    â”‚    â”‚ content      â”‚    â”‚    â”‚ userId      â”‚â”€â”¼â”€â”
â”‚ avatar      â”‚    â””â”€â”€â”€<â”‚ authorId     â”‚    â””â”€â”€â”€<â”‚ createdAt   â”‚ â”‚ â”‚
â”‚ createdAt   â”‚         â”‚ category     â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚ views        â”‚                         â”‚ â”‚
                        â”‚ likes        â”‚                         â”‚ â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ favorites    â”‚                         â”‚ â”‚
      â”‚                 â”‚ status       â”‚                         â”‚ â”‚
      â”‚                 â”‚ createdAt    â”‚                         â”‚ â”‚
      â”‚                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚ â”‚
      â”‚                                                          â”‚ â”‚
      â”‚                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚ â”‚
      â”‚                 â”‚     Like     â”‚                         â”‚ â”‚
      â”‚                 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                         â”‚ â”‚
      â”‚                 â”‚ id           â”‚                         â”‚ â”‚
      â”‚            â”Œâ”€â”€â”€<â”‚ novelId      â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
      â”‚            â”‚    â”‚ userId       â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚            â”‚    â”‚ createdAt    â”‚
      â”‚            â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚            â”‚
      â”‚            â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚            â”‚    â”‚   Favorite   â”‚
      â”‚            â”‚    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
      â”‚            â”‚    â”‚ id           â”‚
      â”‚            â””â”€â”€â”€<â”‚ novelId      â”‚
      â”‚                 â”‚ userId       â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚                 â”‚ createdAt    â”‚           â”‚
      â”‚                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<â”€â”˜
```

---

### æ ¸å¿ƒè¡¨ç»“æ„

#### usersï¼ˆç”¨æˆ·è¡¨ï¼‰

```sql
CREATE TABLE `users` (
  `id` INT AUTO_INCREMENT PRIMARY KEY,
  `username` VARCHAR(50) NOT NULL UNIQUE,
  `email` VARCHAR(100) NOT NULL UNIQUE,
  `password` VARCHAR(255) NOT NULL,
  `avatar` VARCHAR(255),
  `bio` TEXT,
  `membershipType` VARCHAR(20) DEFAULT 'free',
  `membershipExpiresAt` DATETIME,
  `createdAt` DATETIME DEFAULT CURRENT_TIMESTAMP,
  `updatedAt` DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  
  INDEX `idx_email` (`email`),
  INDEX `idx_username` (`username`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

#### novelsï¼ˆå°è¯´è¡¨ï¼‰

```sql
CREATE TABLE `novels` (
  `id` INT AUTO_INCREMENT PRIMARY KEY,
  `title` VARCHAR(200) NOT NULL,
  `summary` TEXT,
  `content` LONGTEXT NOT NULL,
  `category` VARCHAR(50),
  `tags` TEXT,
  `coverType` VARCHAR(20) DEFAULT 'text',
  `coverData` TEXT,
  `views` INT DEFAULT 0,
  `likes` INT DEFAULT 0,
  `favorites` INT DEFAULT 0,
  `status` VARCHAR(20) DEFAULT 'draft',
  `accessLevel` VARCHAR(20) DEFAULT 'free',
  `authorId` INT NOT NULL,
  `publishedAt` DATETIME,
  `createdAt` DATETIME DEFAULT CURRENT_TIMESTAMP,
  `updatedAt` DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  
  INDEX `idx_authorId` (`authorId`),
  INDEX `idx_status` (`status`),
  INDEX `idx_category` (`category`),
  INDEX `idx_createdAt` (`createdAt`),
  FULLTEXT `ft_title_summary` (`title`, `summary`),
  
  FOREIGN KEY (`authorId`) REFERENCES `users`(`id`) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

#### commentsï¼ˆè¯„è®ºè¡¨ï¼‰

```sql
CREATE TABLE `comments` (
  `id` INT AUTO_INCREMENT PRIMARY KEY,
  `content` TEXT NOT NULL,
  `novelId` INT NOT NULL,
  `userId` INT NOT NULL,
  `createdAt` DATETIME DEFAULT CURRENT_TIMESTAMP,
  `updatedAt` DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  
  INDEX `idx_novelId` (`novelId`),
  INDEX `idx_userId` (`userId`),
  
  FOREIGN KEY (`novelId`) REFERENCES `novels`(`id`) ON DELETE CASCADE,
  FOREIGN KEY (`userId`) REFERENCES `users`(`id`) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

#### likesï¼ˆç‚¹èµè¡¨ï¼‰

```sql
CREATE TABLE `likes` (
  `id` INT AUTO_INCREMENT PRIMARY KEY,
  `novelId` INT NOT NULL,
  `userId` INT NOT NULL,
  `createdAt` DATETIME DEFAULT CURRENT_TIMESTAMP,
  
  UNIQUE KEY `uk_novel_user` (`novelId`, `userId`),
  INDEX `idx_novelId` (`novelId`),
  INDEX `idx_userId` (`userId`),
  
  FOREIGN KEY (`novelId`) REFERENCES `novels`(`id`) ON DELETE CASCADE,
  FOREIGN KEY (`userId`) REFERENCES `users`(`id`) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

#### favoritesï¼ˆæ”¶è—è¡¨ï¼‰

```sql
CREATE TABLE `favorites` (
  `id` INT AUTO_INCREMENT PRIMARY KEY,
  `novelId` INT NOT NULL,
  `userId` INT NOT NULL,
  `createdAt` DATETIME DEFAULT CURRENT_TIMESTAMP,
  
  UNIQUE KEY `uk_novel_user` (`novelId`, `userId`),
  INDEX `idx_novelId` (`novelId`),
  INDEX `idx_userId` (`userId`),
  
  FOREIGN KEY (`novelId`) REFERENCES `novels`(`id`) ON DELETE CASCADE,
  FOREIGN KEY (`userId`) REFERENCES `users`(`id`) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

---

### ç´¢å¼•ç­–ç•¥

```yaml
é«˜é¢‘æŸ¥è¯¢å­—æ®µ:
  - users.email         # ç™»å½•
  - users.username      # ç”¨æˆ·æŸ¥æ‰¾
  - novels.authorId     # ä½œè€…ä½œå“åˆ—è¡¨
  - novels.category     # åˆ†ç±»æµè§ˆ
  - novels.status       # çŠ¶æ€ç­›é€‰

å”¯ä¸€çº¦æŸ:
  - users.email
  - users.username
  - likes(novelId, userId)
  - favorites(novelId, userId)

å…¨æ–‡ç´¢å¼•:
  - novels(title, summary)  # æœç´¢åŠŸèƒ½
```

---

## ğŸ”Œ æ¥å£è®¾è®¡

### RESTful APIè§„èŒƒ

```
GET     /api/novels           # è·å–åˆ—è¡¨
GET     /api/novels/:id       # è·å–è¯¦æƒ…
POST    /api/novels           # åˆ›å»º
PUT     /api/novels/:id       # æ›´æ–°
DELETE  /api/novels/:id       # åˆ é™¤

èµ„æºåµŒå¥—ï¼š
GET     /api/novels/:id/comments      # è·å–å°è¯´çš„è¯„è®º
POST    /api/novels/:id/comments      # ä¸ºå°è¯´æ·»åŠ è¯„è®º
```

---

### ç»Ÿä¸€å“åº”æ ¼å¼

```typescript
// æˆåŠŸå“åº”
interface SuccessResponse<T> {
  success: true
  data: T
  message?: string
}

// å¤±è´¥å“åº”
interface ErrorResponse {
  success: false
  error: {
    code: string
    message: string
    details?: any
  }
}

// åˆ†é¡µå“åº”
interface PaginatedResponse<T> {
  success: true
  data: {
    items: T[]
    pagination: {
      page: number
      pageSize: number
      total: number
      totalPages: number
    }
  }
}
```

---

## ğŸ”’ å®‰å…¨æ¶æ„

### è®¤è¯æµç¨‹

```
1. ç”¨æˆ·ç™»å½•
   â†“
2. éªŒè¯ç”¨æˆ·å/å¯†ç 
   â†“
3. ç”ŸæˆJWT Token
   - Payload: { userId, username, role }
   - è¿‡æœŸæ—¶é—´: 24å°æ—¶
   â†“
4. è¿”å›Tokenç»™å®¢æˆ·ç«¯
   â†“
5. å®¢æˆ·ç«¯å­˜å‚¨Tokenï¼ˆlocalStorageï¼‰
   â†“
6. åç»­è¯·æ±‚æºå¸¦Token
   - Header: Authorization: Bearer <token>
   â†“
7. æœåŠ¡ç«¯éªŒè¯Token
   - éªŒè¯ç­¾å
   - æ£€æŸ¥è¿‡æœŸæ—¶é—´
   â†“
8. å…è®¸è®¿é—® / æ‹’ç»è®¿é—®
```

---

### å¯†ç åŠ å¯†

```typescript
// æ³¨å†Œæ—¶åŠ å¯†
const salt = await bcrypt.genSalt(10)
const hashedPassword = await bcrypt.hash(password, salt)

// ç™»å½•æ—¶éªŒè¯
const isValid = await bcrypt.compare(inputPassword, storedHash)
```

---

### æƒé™æ§åˆ¶

```typescript
// è§’è‰²å®šä¹‰
enum UserRole {
  GUEST = 'guest',       // æ¸¸å®¢
  USER = 'user',         // æ™®é€šç”¨æˆ·
  MEMBER = 'member',     // ä¼šå‘˜
  ADMIN = 'admin'        // ç®¡ç†å‘˜
}

// æƒé™çŸ©é˜µ
const permissions = {
  'novel:read': ['guest', 'user', 'member', 'admin'],
  'novel:create': ['user', 'member', 'admin'],
  'novel:delete': ['admin'],  // åªæœ‰ç®¡ç†å‘˜
  'comment:create': ['user', 'member', 'admin'],
}
```

---

## âš¡ æ€§èƒ½ä¼˜åŒ–

### ç¼“å­˜ç­–ç•¥

```yaml
Redisç¼“å­˜å±‚æ¬¡:

1. çƒ­ç‚¹æ•°æ®ç¼“å­˜ï¼ˆ1å°æ—¶ï¼‰:
   - é¦–é¡µæ¨èå°è¯´
   - çƒ­é—¨åˆ†ç±»
   - æ’è¡Œæ¦œ

2. ç”¨æˆ·ä¼šè¯ç¼“å­˜ï¼ˆ24å°æ—¶ï¼‰:
   - ç™»å½•çŠ¶æ€
   - ç”¨æˆ·ä¿¡æ¯

3. æŸ¥è¯¢ç»“æœç¼“å­˜ï¼ˆ30åˆ†é’Ÿï¼‰:
   - å°è¯´åˆ—è¡¨
   - æœç´¢ç»“æœ

ç¼“å­˜å¤±æ•ˆç­–ç•¥:
   - æ•°æ®æ›´æ–°æ—¶ä¸»åŠ¨æ¸…é™¤
   - è®¾ç½®è¿‡æœŸæ—¶é—´
   - LRUæ·˜æ±°
```

---

### æ•°æ®åº“ä¼˜åŒ–

```yaml
æŸ¥è¯¢ä¼˜åŒ–:
  - ä½¿ç”¨ç´¢å¼•
  - é¿å…N+1æŸ¥è¯¢
  - ä½¿ç”¨JOINä»£æ›¿å¤šæ¬¡æŸ¥è¯¢
  - åˆ†é¡µæŸ¥è¯¢

è¿æ¥æ± é…ç½®:
  - æœ€å°è¿æ¥æ•°: 5
  - æœ€å¤§è¿æ¥æ•°: 20
  - è¿æ¥è¶…æ—¶: 10s

æ…¢æŸ¥è¯¢ç›‘æ§:
  - è®°å½•>1sçš„æŸ¥è¯¢
  - å®šæœŸåˆ†æä¼˜åŒ–
```

---

### å‰ç«¯ä¼˜åŒ–

```yaml
ä»£ç åˆ†å‰²:
  - è·¯ç”±æ‡’åŠ è½½
  - ç»„ä»¶å¼‚æ­¥åŠ è½½
  - ç¬¬ä¸‰æ–¹åº“æŒ‰éœ€å¼•å…¥

èµ„æºä¼˜åŒ–:
  - å›¾ç‰‡æ‡’åŠ è½½
  - å›¾ç‰‡å‹ç¼©
  - CDNåŠ é€Ÿ
  - Gzipå‹ç¼©

ç¼“å­˜ç­–ç•¥:
  - Service Worker
  - HTTPç¼“å­˜
  - LocalStorage
```

---

## ğŸš€ éƒ¨ç½²æ¶æ„

### ç”Ÿäº§ç¯å¢ƒæ¶æ„

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  ç”¨æˆ·æµè§ˆå™¨   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
                    â”‚   DNSè§£æ    â”‚
                    â”‚ xs.momofx.cn â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   CDNåŠ é€Ÿ        â”‚
                    â”‚   (é™æ€èµ„æº)      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Nginx          â”‚
                    â”‚   (åå‘ä»£ç†+SSL)  â”‚
                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
                         â”‚        â”‚
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”  â”Œâ”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚ å‰ç«¯é™æ€  â”‚  â”‚ åç«¯API   â”‚
                 â”‚ æ–‡ä»¶      â”‚  â”‚ Node.js   â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚       â”‚        â”‚
                      â”Œâ”€â”€â–¼â”€â”€â” â”Œâ”€â–¼â”€â”€â”  â”Œâ”€â–¼â”€â”€â”
                      â”‚MySQLâ”‚ â”‚Redisâ”‚ â”‚OSS  â”‚
                      â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”˜
```

---

### æœåŠ¡å™¨é…ç½®

```yaml
æœåŠ¡å™¨ç¯å¢ƒ:
  OS: CentOS 7 / Ubuntu 20.04
  CPU: 2æ ¸+
  å†…å­˜: 4GB+
  ç¡¬ç›˜: 50GB+

å®å¡”é¢æ¿:
  - Nginx 1.22
  - MySQL 8.0
  - Redis 7.0
  - PM2ç®¡ç†å™¨
  - Node.js 18.x

åŸŸåé…ç½®:
  - xs.momofx.cn â†’ å‰ç«¯
  - xs.momofx.cn/api â†’ åç«¯API

SSLè¯ä¹¦:
  - Let's Encryptï¼ˆå…è´¹ï¼‰
  - è‡ªåŠ¨ç»­æœŸ
```

---

### è¿›ç¨‹ç®¡ç†ï¼ˆPM2ï¼‰

```javascript
// ecosystem.config.js
module.exports = {
  apps: [{
    name: 'novel-api',
    script: './dist/server.js',
    instances: 2,           // 2ä¸ªè¿›ç¨‹
    exec_mode: 'cluster',   // é›†ç¾¤æ¨¡å¼
    env: {
      NODE_ENV: 'production',
      PORT: 3000
    },
    error_file: './logs/err.log',
    out_file: './logs/out.log',
    log_date_format: 'YYYY-MM-DD HH:mm:ss'
  }]
}
```

---

### ç›‘æ§ä¸æ—¥å¿—

```yaml
æ—¥å¿—æ”¶é›†:
  - åº”ç”¨æ—¥å¿—: PM2æ—¥å¿—
  - é”™è¯¯æ—¥å¿—: error.log
  - è®¿é—®æ—¥å¿—: Nginx access.log

ç›‘æ§æŒ‡æ ‡:
  - CPUä½¿ç”¨ç‡
  - å†…å­˜ä½¿ç”¨ç‡
  - ç£ç›˜ä½¿ç”¨ç‡
  - APIå“åº”æ—¶é—´
  - é”™è¯¯ç‡

å‘Šè­¦æœºåˆ¶:
  - CPU > 80% â†’ é‚®ä»¶å‘Šè­¦
  - é”™è¯¯ç‡ > 5% â†’ çŸ­ä¿¡å‘Šè­¦
  - æœåŠ¡å®•æœº â†’ ç«‹å³é€šçŸ¥
```

---

## ğŸ“Š æ€§èƒ½ç›®æ ‡

```yaml
å“åº”æ—¶é—´:
  - APIå“åº”: < 200ms
  - é¡µé¢åŠ è½½: < 2s
  - é¦–å±æ¸²æŸ“: < 1s

å¹¶å‘èƒ½åŠ›:
  - æ”¯æŒ1000+ å¹¶å‘ç”¨æˆ·
  - QPS: 500+

å¯ç”¨æ€§:
  - æ­£å¸¸è¿è¡Œæ—¶é—´: 99.9%
  - é”™è¯¯ç‡: < 0.1%

æ•°æ®åº“:
  - æŸ¥è¯¢å“åº”: < 100ms
  - è¿æ¥æ± åˆ©ç”¨ç‡: < 80%
```

---

## ğŸ”„ æ‰©å±•æ€§è®¾è®¡

### æ°´å¹³æ‰©å±•

```
å½“å‰æ¶æ„ â†’ å•æœºéƒ¨ç½²
  â†“
è´Ÿè½½å¢åŠ  â†’ Nginxè´Ÿè½½å‡è¡¡ + å¤šå®ä¾‹
  â†“
ç»§ç»­å¢é•¿ â†’ æ•°æ®åº“è¯»å†™åˆ†ç¦»
  â†“
é«˜å¹¶å‘  â†’ å¾®æœåŠ¡æ‹†åˆ†
```

---

### å¾®æœåŠ¡é¢„ç•™

```
å½“å‰å•ä½“åº”ç”¨å¯æ‹†åˆ†ä¸º:

- è®¤è¯æœåŠ¡ï¼ˆAuth Serviceï¼‰
- ç”¨æˆ·æœåŠ¡ï¼ˆUser Serviceï¼‰
- å°è¯´æœåŠ¡ï¼ˆNovel Serviceï¼‰
- è¯„è®ºæœåŠ¡ï¼ˆComment Serviceï¼‰
- æœç´¢æœåŠ¡ï¼ˆSearch Serviceï¼‰
- é€šçŸ¥æœåŠ¡ï¼ˆNotification Serviceï¼‰
```

---

## âœ… æ¶æ„éªŒæ”¶æ ‡å‡†

```
âœ… æŠ€æœ¯é€‰å‹åˆç†
âœ… åˆ†å±‚æ¸…æ™°
âœ… æ¥å£è®¾è®¡è§„èŒƒ
âœ… æ•°æ®åº“è®¾è®¡åˆç†
âœ… å®‰å…¨æªæ–½å®Œå–„
âœ… æ€§èƒ½ç›®æ ‡æ˜ç¡®
âœ… å¯æ‰©å±•æ€§è‰¯å¥½
âœ… æ–‡æ¡£å®Œæ•´
```

---

**æ¶æ„å¸ˆï¼š** å·¥ç¨‹å¸ˆA  
**è¯„å®¡æ—¥æœŸï¼š** å¾…å®š  
**æœ€åæ›´æ–°ï¼š** 2025-10-27  
**ç‰ˆæœ¬ï¼š** v1.0

