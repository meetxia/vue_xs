# 🧪 前后端对接测试指南

**测试时间**: 立即可以开始  
**预计时间**: 30分钟  
**测试人员**: 工程师B（前端）+ 工程师A/C（后端）

---

## 🚀 快速启动

### 1. 启动后端服务

```bash
# 进入后端目录
cd vue_xs/backend

# 确保依赖已安装
npm install

# 启动开发服务器
npm run dev
```

**预期输出**:
```
Server listening at http://localhost:3000
✓ Database connected
✓ All routes registered
```

### 2. 启动前端服务

```bash
# 打开新终端
# 进入前端目录
cd vue_xs/frontend

# 确保依赖已安装
npm install

# 启动开发服务器
npm run dev
```

**预期输出**:
```
VITE v5.x.x  ready in xxx ms

➜  Local:   http://localhost:5173/
➜  Network: use --host to expose
```

### 3. 浏览器访问

打开浏览器访问: **http://localhost:5173**

---

## ✅ 测试清单

### 第一部分：认证功能测试（5分钟）

#### 1.1 用户注册测试 ✅

**测试步骤**:
1. 点击首页"注册"按钮
2. 填写注册表单：
   - 用户名: `testuser_001`
   - 邮箱: `test001@example.com`
   - 密码: `Test123456!`
   - 确认密码: `Test123456!`
3. 点击"注册"按钮

**预期结果**:
- ✅ 显示"注册成功"提示
- ✅ 自动跳转到首页
- ✅ 右上角显示用户名
- ✅ Token已保存到localStorage

**失败排查**:
- 检查后端服务是否启动
- 检查网络请求（F12 → Network）
- 查看控制台错误信息

#### 1.2 用户登录测试 ✅

**测试步骤**:
1. 点击"退出登录"
2. 点击"登录"按钮
3. 填写登录表单：
   - 邮箱: `test001@example.com`
   - 密码: `Test123456!`
4. 点击"登录"按钮

**预期结果**:
- ✅ 显示"登录成功"提示
- ✅ 跳转到首页
- ✅ 右上角显示用户信息

---

### 第二部分：小说功能测试（10分钟）

#### 2.1 小说列表测试 ✅

**测试步骤**:
1. 访问首页
2. 查看小说列表

**预期结果**:
- ✅ 显示小说卡片列表
- ✅ 每个卡片显示封面、标题、作者、统计信息
- ✅ 悬停时显示"开始阅读"按钮

#### 2.2 小说详情测试 ✅

**测试步骤**:
1. 点击任意小说卡片
2. 查看详情页内容

**预期结果**:
- ✅ 显示小说完整信息
- ✅ 显示作者信息
- ✅ 显示统计数据（阅读量、点赞、收藏）
- ✅ 显示标签
- ✅ 显示操作按钮

#### 2.3 点赞功能测试 ✅

**测试步骤**:
1. 在小说详情页点击"点赞"按钮
2. 再次点击"点赞"按钮（取消）

**预期结果**:
- ✅ 第一次点击：按钮变为"已点赞"，点赞数+1
- ✅ 第二次点击：按钮变为"点赞"，点赞数-1
- ✅ 显示相应的成功提示

#### 2.4 收藏功能测试 ✅

**测试步骤**:
1. 在小说详情页点击"收藏"按钮
2. 再次点击"收藏"按钮（取消）

**预期结果**:
- ✅ 第一次点击：按钮变为"已收藏"，收藏数+1
- ✅ 第二次点击：按钮变为"收藏"，收藏数-1
- ✅ 显示相应的成功提示

---

### 第三部分：评论功能测试（5分钟）

#### 3.1 查看评论列表 ✅

**测试步骤**:
1. 在小说详情页滚动到评论区
2. 查看评论列表

**预期结果**:
- ✅ 显示评论列表（如果有）
- ✅ 每条评论显示用户头像、用户名、内容、时间
- ✅ 如果没有评论，显示空状态提示

#### 3.2 发表评论测试 ✅

**测试步骤**:
1. 点击"发表评论"按钮
2. 在弹窗中输入评论内容：
   ```
   这本小说真不错！期待更新！
   ```
3. 点击"确定"按钮

**预期结果**:
- ✅ 显示"评论发表成功"提示
- ✅ 弹窗关闭
- ✅ 评论列表自动刷新
- ✅ 新评论显示在列表中

---

### 第四部分：用户中心测试（10分钟）

#### 4.1 查看个人信息 ✅

**测试步骤**:
1. 点击右上角用户头像
2. 选择"个人中心"
3. 查看个人信息

**预期结果**:
- ✅ 显示用户头像
- ✅ 显示用户名
- ✅ 显示邮箱
- ✅ 显示个人简介（如果有）

#### 4.2 编辑资料测试 ✅

**测试步骤**:
1. 点击"编辑资料"按钮
2. 修改个人简介：
   ```
   热爱阅读，喜欢科幻和玄幻小说
   ```
3. 点击"保存"按钮

**预期结果**:
- ✅ 显示"保存成功"提示
- ✅ 个人简介已更新
- ✅ 右上角用户信息同步更新

#### 4.3 上传头像测试 ✅

**测试步骤**:
1. 点击"更换头像"按钮
2. 选择一张图片（< 2MB）
3. 确认上传

**预期结果**:
- ✅ 显示"上传中..."加载提示
- ✅ 上传成功后显示"头像上传成功"
- ✅ 头像立即更新
- ✅ 右上角头像同步更新

**文件限制测试**:
- 尝试上传超过2MB的图片
- 预期：显示"图片大小不能超过2MB"

#### 4.4 修改密码测试 ✅

**测试步骤**:
1. 切换到"修改密码"标签
2. 填写表单：
   - 当前密码: `Test123456!`
   - 新密码: `NewPass123!`
   - 确认密码: `NewPass123!`
3. 点击"修改密码"按钮

**预期结果**:
- ✅ 显示"密码修改成功，请重新登录"
- ✅ 3秒后自动退出登录
- ✅ 跳转到登录页

**重新登录验证**:
1. 使用新密码登录
2. 预期：登录成功

#### 4.5 收藏列表测试 ✅

**测试步骤**:
1. 切换到"我的收藏"标签
2. 查看收藏列表

**预期结果**:
- ✅ 显示已收藏的小说（如果有）
- ✅ 使用NovelCard组件展示
- ✅ 如果没有收藏，显示空状态

#### 4.6 我的作品测试 ✅

**测试步骤**:
1. 切换到"我的作品"标签
2. 查看作品列表

**预期结果**:
- ✅ 显示创建的小说（如果有）
- ✅ 显示"创建作品"按钮
- ✅ 如果没有作品，显示空状态

---

## 🐛 常见问题排查

### 问题1: 网络请求失败

**症状**: 所有API请求都显示"网络错误"

**排查步骤**:
1. 检查后端服务是否启动
   ```bash
   # 访问: http://localhost:3000/health
   # 预期返回: {"status":"ok",...}
   ```

2. 检查前端baseURL配置
   ```typescript
   // vue_xs/frontend/src/utils/request.ts
   baseURL: 'http://localhost:3000/api' // 确认这个配置正确
   ```

3. 查看浏览器控制台错误信息

**解决方案**:
- 重启后端服务
- 检查端口占用
- 清除浏览器缓存

---

### 问题2: Token失效

**症状**: 登录后立即显示"未授权"

**排查步骤**:
1. 检查localStorage中的token
   ```javascript
   // F12 → Application → Local Storage
   // 查看是否有 'token' 键
   ```

2. 检查请求头
   ```javascript
   // F12 → Network → 选择任意API请求
   // Headers → Authorization: Bearer xxx
   ```

**解决方案**:
- 清除localStorage
- 重新登录
- 检查后端JWT配置

---

### 问题3: 文件上传失败

**症状**: 头像上传一直失败

**排查步骤**:
1. 检查文件大小（应 < 2MB）
2. 检查文件类型（应为图片）
3. 查看控制台错误信息

**解决方案**:
- 使用符合要求的图片
- 检查后端上传配置
- 检查上传目录权限

---

### 问题4: 评论不显示

**症状**: 发表评论成功但列表不更新

**排查步骤**:
1. 检查Network请求是否成功
2. 检查评论数据格式
3. 刷新页面查看

**解决方案**:
- 检查loadComments()函数
- 检查评论数据结构
- 查看控制台错误

---

## 📋 测试报告模板

### 测试结果记录

**测试时间**: ____________  
**测试人员**: ____________

| 功能模块 | 测试项 | 预期结果 | 实际结果 | 状态 | 备注 |
|---------|--------|---------|---------|------|------|
| 认证 | 用户注册 | 注册成功 | | ☐ 通过 ☐ 失败 | |
| 认证 | 用户登录 | 登录成功 | | ☐ 通过 ☐ 失败 | |
| 小说 | 列表展示 | 正常显示 | | ☐ 通过 ☐ 失败 | |
| 小说 | 详情查看 | 正常显示 | | ☐ 通过 ☐ 失败 | |
| 小说 | 点赞功能 | 正常切换 | | ☐ 通过 ☐ 失败 | |
| 小说 | 收藏功能 | 正常切换 | | ☐ 通过 ☐ 失败 | |
| 评论 | 查看列表 | 正常显示 | | ☐ 通过 ☐ 失败 | |
| 评论 | 发表评论 | 发表成功 | | ☐ 通过 ☐ 失败 | |
| 用户 | 查看资料 | 正常显示 | | ☐ 通过 ☐ 失败 | |
| 用户 | 编辑资料 | 保存成功 | | ☐ 通过 ☐ 失败 | |
| 用户 | 上传头像 | 上传成功 | | ☐ 通过 ☐ 失败 | |
| 用户 | 修改密码 | 修改成功 | | ☐ 通过 ☐ 失败 | |
| 用户 | 收藏列表 | 正常显示 | | ☐ 通过 ☐ 失败 | |
| 用户 | 我的作品 | 正常显示 | | ☐ 通过 ☐ 失败 | |

**总通过率**: _____ / 14

---

## 🎉 测试通过标准

### 全部通过条件
- ✅ 所有14项测试全部通过
- ✅ 无控制台错误
- ✅ 无网络请求失败
- ✅ 用户体验流畅

### 可接受条件
- ✅ 核心功能（认证、小说、评论）全部通过
- ✅ 次要功能有1-2项失败但不影响使用
- ✅ 有错误但有fallback处理

---

## 📞 支持联系

**前端问题**: 联系工程师B  
**后端问题**: 联系工程师A或工程师C  
**数据库问题**: 联系工程师C

---

## 🚀 测试通过后的下一步

1. **提交代码**
   ```bash
   git add .
   git commit -m "feat: 完成前后端API对接"
   git push
   ```

2. **更新文档**
   - 记录测试结果
   - 更新已知问题
   - 完善使用说明

3. **规划Week2**
   - 阅读器开发
   - 搜索功能
   - 性能优化

---

**祝测试顺利！** 🎉

