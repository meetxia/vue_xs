# 🚀 立即开始 - 今天就能动手！

**适用环境：** Windows本地开发（XAMPP） + 三人团队  
**预计时间：** 2-3小时完成基础环境  
**目标：** 今天下午就能开始写代码！

---

## ⚡ 超快速启动（30分钟）

### 你已经有的 ✅

- ✅ XAMPP已安装并运行（Apache + MySQL）
- ✅ MySQL运行在 localhost:3306
- ✅ 数据库账号：`toefl_user` / `mojz168168`
- ✅ 阿里云服务器已有宝塔面板

### 你需要安装的（3个软件）

1. **Node.js 18.x** (10分钟)
   - 下载：https://nodejs.org/zh-cn/
   - 选择LTS版本
   - 双击安装，一路Next
   - 验证：打开CMD，输入 `node -v`

2. **Git** (5分钟)
   - 下载：https://git-scm.com/download/win
   - 双击安装，一路Next
   - 验证：打开CMD，输入 `git --version`

3. **VS Code** (5分钟)
   - 下载：https://code.visualstudio.com/
   - 双击安装
   - 安装插件：Volar, Prisma

---

## 📦 第一步：创建项目（15分钟）

### 在CMD或PowerShell执行：

```powershell
# 1. 进入项目根目录
cd H:\momo-ruanjiansheji\axs_html\deploy-package

# 2. 创建项目目录
mkdir vue_xs
cd vue_xs

# 3. 创建基础结构
mkdir frontend backend docs scripts

# 4. 用VS Code打开
code .
```

---

## 🗄️ 第二步：创建数据库（5分钟）

### 在phpMyAdmin操作：

1. **打开phpMyAdmin**
   - 浏览器访问：http://127.0.0.1/phpmyadmin/
   - 或点击XAMPP控制面板的「Admin」按钮

2. **登录**
   - 用户名：`toefl_user`
   - 密码：`mojz168168`

3. **创建数据库**
   - 点击左侧「新建」
   - 数据库名：`momo_novel_db`
   - 排序规则：`utf8mb4_unicode_ci`
   - 点击「创建」

✅ 完成！现在你有了一个空数据库。

---

## 🎨 第三步：前端项目初始化（工程师B，20分钟）

### 在 VS Code 终端执行：

```powershell
# 1. 进入前端目录
cd frontend

# 2. 创建Vue 3项目
npm create vite@latest . -- --template vue-ts
# 提示: Remove existing files and continue? 选择 y

# 3. 安装基础依赖
npm install

# 4. 安装UI框架
npm install element-plus @element-plus/icons-vue

# 5. 安装路由和状态管理
npm install vue-router pinia axios

# 6. 安装Tailwind CSS
npm install -D tailwindcss postcss autoprefixer
npx tailwindcss init -p

# 7. 启动开发服务器测试
npm run dev

# 浏览器自动打开 http://localhost:5188
# 看到Vue的欢迎页面就成功了！✅
```

### 配置Tailwind CSS

**创建 `frontend/src/assets/style.css`：**

```css
@tailwind base;
@tailwind components;
@tailwind utilities;

/* 自定义样式 */
:root {
  --xhs-red: #FE2C55;
  --beige: #F5E6D3;
  --beige-light: #FAF5F0;
}
```

**修改 `frontend/tailwind.config.js`：**

```javascript
/** @type {import('tailwindcss').Config} */
export default {
  content: [
    "./index.html",
    "./src/**/*.{vue,js,ts,jsx,tsx}",
  ],
  theme: {
    extend: {
      colors: {
        'xhs-red': '#FE2C55',
        'beige': '#F5E6D3',
        'beige-light': '#FAF5F0',
      }
    },
  },
  plugins: [],
}
```

**修改 `frontend/src/main.ts`：**

```typescript
import { createApp } from 'vue'
import './assets/style.css'  // 引入Tailwind
import App from './App.vue'

createApp(App).mount('#app')
```

---

## 🔧 第四步：后端项目初始化（工程师C，25分钟）

### 在 VS Code 新终端执行：

```powershell
# 1. 进入后端目录
cd backend

# 2. 初始化package.json
npm init -y

# 3. 安装核心依赖
npm install fastify @fastify/cors @fastify/jwt @fastify/multipart
npm install @prisma/client bcrypt jsonwebtoken dotenv

# 4. 安装开发依赖
npm install -D typescript @types/node ts-node nodemon prisma
npm install -D @types/bcrypt @types/jsonwebtoken

# 5. 初始化TypeScript
npx tsc --init

# 6. 初始化Prisma
npx prisma init
```

### 配置数据库连接

**编辑 `backend/.env`：**

```env
NODE_ENV=development
PORT=3000

# 本地XAMPP的MySQL连接
DATABASE_URL="mysql://toefl_user:mojz168168@localhost:3306/momo_novel_db"

JWT_SECRET=dev-secret-key-12345678
```

### 创建Prisma Schema

**复制以下内容到 `backend/prisma/schema.prisma`：**

```prisma
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model User {
  id        Int      @id @default(autoincrement())
  username  String   @unique @db.VarChar(50)
  email     String   @unique @db.VarChar(100)
  password  String   @db.VarChar(255)
  avatar    String?  @db.VarChar(255)
  bio       String?  @db.Text
  
  membershipType      String?   @default("free") @db.VarChar(20)
  membershipExpiresAt DateTime? @db.DateTime(0)
  
  novels     Novel[]
  comments   Comment[]
  likes      Like[]
  favorites  Favorite[]
  
  createdAt DateTime @default(now()) @db.DateTime(0)
  updatedAt DateTime @updatedAt @db.DateTime(0)

  @@index([email])
  @@index([username])
  @@map("users")
}

model Novel {
  id          Int       @id @default(autoincrement())
  title       String    @db.VarChar(200)
  summary     String?   @db.Text
  content     String    @db.LongText
  category    String?   @db.VarChar(50)
  tags        String?   @db.Text
  
  coverType   String    @default("text") @db.VarChar(20)
  coverData   String?   @db.Text
  
  views       Int       @default(0)
  likes       Int       @default(0)
  favorites   Int       @default(0)
  
  status      String    @default("draft") @db.VarChar(20)
  accessLevel String    @default("free") @db.VarChar(20)
  
  authorId    Int
  author      User      @relation(fields: [authorId], references: [id], onDelete: Cascade)
  
  comments    Comment[]
  likeList    Like[]
  favoriteList Favorite[]
  
  publishedAt DateTime? @db.DateTime(0)
  createdAt   DateTime  @default(now()) @db.DateTime(0)
  updatedAt   DateTime  @updatedAt @db.DateTime(0)

  @@index([authorId])
  @@index([status])
  @@index([category])
  @@fulltext([title, summary])
  @@map("novels")
}

model Comment {
  id        Int      @id @default(autoincrement())
  content   String   @db.Text
  
  novelId   Int
  novel     Novel    @relation(fields: [novelId], references: [id], onDelete: Cascade)
  
  userId    Int
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  createdAt DateTime @default(now()) @db.DateTime(0)
  updatedAt DateTime @updatedAt @db.DateTime(0)

  @@index([novelId])
  @@index([userId])
  @@map("comments")
}

model Like {
  id        Int      @id @default(autoincrement())
  
  novelId   Int
  novel     Novel    @relation(fields: [novelId], references: [id], onDelete: Cascade)
  
  userId    Int
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  createdAt DateTime @default(now()) @db.DateTime(0)

  @@unique([novelId, userId])
  @@index([novelId])
  @@index([userId])
  @@map("likes")
}

model Favorite {
  id        Int      @id @default(autoincrement())
  
  novelId   Int
  novel     Novel    @relation(fields: [novelId], references: [id], onDelete: Cascade)
  
  userId    Int
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  createdAt DateTime @default(now()) @db.DateTime(0)

  @@unique([novelId, userId])
  @@index([novelId])
  @@index([userId])
  @@map("favorites")
}
```

### 创建数据库表

```powershell
# 生成Prisma Client
npx prisma generate

# 创建数据库表（自动创建所有表）
npx prisma db push

# 打开可视化界面查看
npx prisma studio
# 访问 http://localhost:5555
```

### 验证数据库

打开phpMyAdmin，刷新左侧数据库列表，应该能看到：

```
momo_novel_db
├─ users         (用户表)
├─ novels        (小说表)
├─ comments      (评论表)
├─ likes         (点赞表)
└─ favorites     (收藏表)
```

✅ **成功！数据库表已创建！**

---

## 🎯 今天下午就开始开发！

### 工程师C：创建第一个API（20分钟）

**创建 `backend/src/server.ts`：**

```typescript
import Fastify from 'fastify'
import cors from '@fastify/cors'
import { PrismaClient } from '@prisma/client'

const fastify = Fastify({
  logger: true
})

const prisma = new PrismaClient()

// CORS配置（允许前端访问）
fastify.register(cors, {
  origin: ['http://localhost:5188', 'http://127.0.0.1:5188'],
  credentials: true
})

// ==========================================
// 健康检查API
// ==========================================
fastify.get('/api/health', async () => {
  return {
    status: 'ok',
    timestamp: new Date().toISOString()
  }
})

// ==========================================
// 测试数据库连接
// ==========================================
fastify.get('/api/test-db', async () => {
  try {
    const userCount = await prisma.user.count()
    const novelCount = await prisma.novel.count()
    
    return {
      success: true,
      message: '数据库连接成功！',
      data: {
        users: userCount,
        novels: novelCount
      }
    }
  } catch (error: any) {
    return {
      success: false,
      message: '数据库连接失败',
      error: error.message
    }
  }
})

// ==========================================
// 获取小说列表API（示例）
// ==========================================
fastify.get('/api/novels', async (request, reply) => {
  try {
    const novels = await prisma.novel.findMany({
      take: 20,
      orderBy: {
        createdAt: 'desc'
      },
      include: {
        author: {
          select: {
            id: true,
            username: true,
            avatar: true
          }
        }
      }
    })

    return {
      success: true,
      data: {
        novels,
        total: novels.length
      }
    }
  } catch (error: any) {
    reply.code(500)
    return {
      success: false,
      message: error.message
    }
  }
})

// 启动服务器
const start = async () => {
  try {
    const port = Number(process.env.PORT) || 3000
    await fastify.listen({ port, host: '0.0.0.0' })
    
    console.log(`
╔════════════════════════════════════════╗
║  🚀 后端服务器启动成功！                ║
║  📍 地址: http://localhost:${port}     ║
║  📡 API: http://localhost:${port}/api  ║
║  ⏰ 时间: ${new Date().toLocaleString()} ║
╚════════════════════════════════════════╝

测试API:
  http://localhost:3000/api/health
  http://localhost:3000/api/test-db
  http://localhost:3000/api/novels
    `)
  } catch (err) {
    fastify.log.error(err)
    process.exit(1)
  }
}

start()
```

**配置 `backend/package.json`：**

```json
{
  "name": "momo-novel-backend",
  "version": "1.0.0",
  "scripts": {
    "dev": "nodemon --exec ts-node src/server.ts",
    "build": "tsc",
    "start": "node dist/server.js"
  },
  "dependencies": {
    "fastify": "^4.25.2",
    "@fastify/cors": "^8.5.0",
    "@fastify/jwt": "^7.2.4",
    "@fastify/multipart": "^8.1.0",
    "@prisma/client": "^5.9.0",
    "bcrypt": "^5.1.1",
    "jsonwebtoken": "^9.0.2",
    "dotenv": "^16.4.1"
  },
  "devDependencies": {
    "typescript": "^5.3.3",
    "@types/node": "^20.11.5",
    "ts-node": "^10.9.2",
    "nodemon": "^3.0.3",
    "prisma": "^5.9.0",
    "@types/bcrypt": "^5.0.2",
    "@types/jsonwebtoken": "^9.0.5"
  }
}
```

**启动后端：**

```powershell
cd backend
npm run dev

# 看到启动成功的信息后
# 浏览器访问 http://localhost:3000/api/health
# 应该看到: {"status":"ok","timestamp":"..."}
```

---

## 🎨 工程师B：前端第一个页面（30分钟）

### 创建测试页面

**修改 `frontend/src/App.vue`：**

```vue
<script setup lang="ts">
import { ref, onMounted } from 'vue'
import axios from 'axios'

const novels = ref([])
const loading = ref(false)

const loadNovels = async () => {
  loading.value = true
  try {
    const response = await axios.get('http://localhost:3000/api/novels')
    novels.value = response.data.data.novels
  } catch (error) {
    console.error('加载失败:', error)
  } finally {
    loading.value = false
  }
}

onMounted(() => {
  loadNovels()
})
</script>

<template>
  <div class="min-h-screen bg-gray-50 p-8">
    <div class="max-w-6xl mx-auto">
      <h1 class="text-3xl font-bold text-center mb-8 text-red-500">
        MOMO炒饭店 - Vue 3 版本
      </h1>

      <div v-if="loading" class="text-center">
        加载中...
      </div>

      <div v-else class="grid grid-cols-1 md:grid-cols-3 gap-4">
        <div 
          v-for="novel in novels" 
          :key="novel.id"
          class="bg-white rounded-lg shadow-md p-4 hover:shadow-lg transition"
        >
          <h3 class="font-bold text-lg mb-2">{{ novel.title }}</h3>
          <p class="text-gray-600 text-sm line-clamp-3">{{ novel.summary }}</p>
          <div class="mt-4 flex items-center justify-between text-sm text-gray-500">
            <span>👁️ {{ novel.views }}</span>
            <span>❤️ {{ novel.likes }}</span>
          </div>
        </div>
      </div>

      <div v-if="!loading && novels.length === 0" class="text-center text-gray-500">
        暂无数据，请先添加小说
      </div>
    </div>
  </div>
</template>
```

**启动前端：**

```powershell
cd frontend
npm run dev

# 访问 http://localhost:5188
# 应该能看到页面了！✅
```

---

## 🗂️ 导入现有数据（可选）

如果你想把旧系统的数据导入到新数据库：

### 创建数据迁移脚本

**创建 `backend/scripts/migrate-data.ts`：**

```typescript
import { PrismaClient } from '@prisma/client'
import * as fs from 'fs'
import * as path from 'path'

const prisma = new PrismaClient()

async function migrate() {
  console.log('🚀 开始迁移数据...\n')

  // 读取旧数据（修改为你的实际路径）
  const oldDataPath = '../../deploy-package/data'
  
  const usersData = JSON.parse(
    fs.readFileSync(path.resolve(__dirname, oldDataPath, 'users.json'), 'utf-8')
  )
  const novelsData = JSON.parse(
    fs.readFileSync(path.resolve(__dirname, oldDataPath, 'novels.json'), 'utf-8')
  )

  // 迁移用户
  console.log('📝 迁移用户...')
  for (const user of usersData.users || []) {
    try {
      await prisma.user.create({
        data: {
          id: user.id,
          username: user.username,
          email: user.email,
          password: user.password,
          avatar: user.avatar,
          bio: user.bio,
          membershipType: user.membership?.type || 'free',
          membershipExpiresAt: user.membership?.expiresAt 
            ? new Date(user.membership.expiresAt) 
            : null
        }
      })
      console.log(`  ✅ ${user.username}`)
    } catch (error: any) {
      console.log(`  ⚠️  ${user.username} - ${error.message}`)
    }
  }

  // 迁移小说
  console.log('\n📚 迁移小说...')
  for (const novel of novelsData.novels || []) {
    try {
      await prisma.novel.create({
        data: {
          id: novel.id,
          title: novel.title,
          summary: novel.summary,
          content: novel.content,
          category: novel.category,
          tags: novel.tags ? JSON.stringify(novel.tags) : null,
          coverType: novel.coverType || 'text',
          coverData: novel.coverData ? JSON.stringify(novel.coverData) : null,
          views: novel.views || 0,
          likes: novel.likes || 0,
          favorites: novel.favorites || 0,
          status: novel.status || 'published',
          accessLevel: novel.accessLevel || 'free',
          authorId: 1, // 默认作者ID
          publishedAt: novel.publishTime ? new Date(novel.publishTime) : null
        }
      })
      console.log(`  ✅ ${novel.title}`)
    } catch (error: any) {
      console.log(`  ⚠️  ${novel.title} - ${error.message}`)
    }
  }

  console.log('\n🎉 迁移完成！')
  
  await prisma.$disconnect()
}

migrate()
```

**执行迁移：**

```powershell
cd backend
npx ts-node scripts/migrate-data.ts

# 刷新前端页面，应该能看到小说列表了！
```

---

## ✅ 第一天完成检查清单

### 环境搭建 ✅

- [ ] Node.js已安装（`node -v`）
- [ ] Git已安装（`git --version`）
- [ ] VS Code已安装
- [ ] XAMPP的MySQL正在运行

### 数据库 ✅

- [ ] 数据库 `momo_novel_db` 已创建
- [ ] Prisma已配置
- [ ] 数据库表已创建（5张表）
- [ ] 可以访问 Prisma Studio

### 前端 ✅

- [ ] Vue 3项目已创建
- [ ] 依赖已安装
- [ ] 开发服务器可启动
- [ ] 访问 http://localhost:5188 正常

### 后端 ✅

- [ ] Fastify项目已创建
- [ ] 依赖已安装
- [ ] 数据库连接成功
- [ ] 访问 http://localhost:3000/api/health 正常

### 团队 ✅

- [ ] Git仓库已创建
- [ ] 三人分工明确
- [ ] 沟通方式确定

---

## 📱 团队微信群模板

```
群名: MOMO小说重构开发组

工程师A (Leader):
- 负责: 架构、认证、部署
- 微信: ____________

工程师B (前端):
- 负责: 所有前端页面
- 微信: ____________

工程师C (后端):
- 负责: 所有后端API
- 微信: ____________

每日站会: 09:00
代码评审: 17:00
紧急问题: @全体成员
```

---

## 📅 明天开始正式开发

### Week 1 剩余时间安排

**工程师A：**
- [ ] Day 2-3: 设计API接口文档
- [ ] Day 4-5: 开发JWT认证中间件
- [ ] 周末: Code Review

**工程师B：**
- [ ] Day 2: 开发公共组件（Button, Input, Modal）
- [ ] Day 3-4: 登录注册页面
- [ ] Day 5: 路由配置和状态管理
- [ ] 周末: 自测

**工程师C：**
- [ ] Day 2-3: 用户注册登录API
- [ ] Day 4: 用户信息API
- [ ] Day 5: API文档（Swagger）
- [ ] 周末: 单元测试

---

## 🛠️ 开发工具推荐

### VS Code插件

```
必装:
✅ Volar (Vue 3支持)
✅ Prisma (数据库提示)
✅ ESLint (代码检查)
✅ Prettier (格式化)

推荐:
- GitLens (Git增强)
- Auto Rename Tag
- Path Intellisense
- REST Client (测试API)
```

### Chrome插件

```
✅ Vue.js DevTools
✅ JSON Viewer
✅ React Developer Tools (如果用React)
```

---

## 🆘 遇到问题怎么办？

### 常见问题速查

**Q1: Prisma连接数据库失败**

```powershell
# 1. 检查MySQL是否启动
# XAMPP控制面板 → MySQL → Start

# 2. 检查.env配置
# DATABASE_URL="mysql://toefl_user:mojz168168@localhost:3306/momo_novel_db"

# 3. 测试连接
npx prisma db pull

# 4. 如果还是失败，检查MySQL权限
# phpMyAdmin → 用户账户 → toefl_user → 编辑权限
```

**Q2: 前端访问后端API跨域**

```typescript
// backend/src/server.ts
fastify.register(cors, {
  origin: ['http://localhost:5188', 'http://127.0.0.1:5188'],
  credentials: true
})
```

**Q3: npm install很慢**

```powershell
# 使用国内镜像
npm config set registry https://registry.npmmirror.com

# 或使用pnpm（更快）
npm install -g pnpm
pnpm install
```

**Q4: TypeScript报错**

```powershell
# 重新生成类型
cd backend
npx prisma generate

# 重启VS Code的TS服务
# Ctrl+Shift+P → TypeScript: Restart TS Server
```

---

## 🎁 附赠：快速开发模板

### API快速模板

```typescript
// backend/src/routes/example.ts
import { FastifyInstance } from 'fastify'
import { PrismaClient } from '@prisma/client'

const prisma = new PrismaClient()

export default async function exampleRoutes(fastify: FastifyInstance) {
  // 获取列表
  fastify.get('/', async (request, reply) => {
    const items = await prisma.user.findMany()
    return { success: true, data: items }
  })

  // 获取详情
  fastify.get('/:id', async (request, reply) => {
    const { id } = request.params as { id: string }
    const item = await prisma.user.findUnique({
      where: { id: parseInt(id) }
    })
    return { success: true, data: item }
  })

  // 创建
  fastify.post('/', async (request, reply) => {
    const data = request.body as any
    const item = await prisma.user.create({ data })
    return { success: true, data: item }
  })
}
```

### Vue组件快速模板

```vue
<script setup lang="ts">
import { ref, onMounted } from 'vue'

// Props
const props = defineProps<{
  title: string
}>()

// State
const data = ref([])
const loading = ref(false)

// Methods
const loadData = async () => {
  loading.value = true
  try {
    // API调用
  } finally {
    loading.value = false
  }
}

// Lifecycle
onMounted(() => {
  loadData()
})
</script>

<template>
  <div class="container">
    <h1>{{ title }}</h1>
    <!-- 你的内容 -->
  </div>
</template>

<style scoped>
.container {
  padding: 20px;
}
</style>
```

---

## 📞 需要帮助？

如果遇到问题，按这个顺序解决：

1. **Google/百度** - 大部分问题都能找到答案
2. **查看报错信息** - 仔细阅读错误提示
3. **查看文档** - Vue/Prisma官方文档
4. **问AI** - Claude/ChatGPT/通义千问
5. **问我** - 如果还是解决不了

---

## 🎯 今天的目标

### ✅ 工程师A（架构师）

- [x] 项目目录创建
- [x] Git仓库配置
- [ ] 设计API接口文档（Excel或在线文档）
- [ ] 编写开发规范

### ✅ 工程师B（前端）

- [x] Vue 3项目搭建
- [x] 测试页面运行
- [ ] 学习Vue 3 Composition API（2小时）
- [ ] 规划组件结构

### ✅ 工程师C（后端）

- [x] Fastify项目搭建
- [x] 数据库表创建
- [x] 第一个API运行
- [ ] 学习Prisma基础（1小时）

---

## 🚀 明天开始写业务代码！

**工程师A：** 开发JWT认证中间件  
**工程师B：** 开发登录注册页面  
**工程师C：** 开发注册登录API  

**一周后：** 用户可以注册登录了！  
**两周后：** 可以发布和阅读小说了！  
**八周后：** 全新系统上线！

---

**现在就开始吧！** 💪

**第一步：**
1. 安装Node.js（如果还没装）
2. 打开CMD，执行：
   ```
   cd H:\momo-ruanjiansheji\axs_html\deploy-package
   mkdir vue_xs
   cd vue_xs
   code .
   ```
3. 按照上面步骤一步步来！

**祝开发顺利！** 🎉

