# 🚀 快速启动指南 - 三人团队版

**立即开始：** 本文档帮助团队在**1天内**完成环境搭建，正式开始开发！

---

## 📋 开始前的准备清单

### ✅ 团队确认

- [ ] 确认3位工程师到位
- [ ] 明确角色分工（工程师A/B/C）
- [ ] 建立微信/钉钉沟通群
- [ ] 创建Git代码仓库

### ✅ 服务器准备

- [ ] 阿里云服务器已购买（2核4G起）
- [ ] 服务器IP地址：`____________`
- [ ] 服务器root密码：`____________`
- [ ] 域名已备案：`xs.momofx.cn`

### ✅ 数据库信息

```
数据库类型：MySQL 8.0
数据库名：momo_novel_db
用户名：toefl_user
密码：mojz168168
```

---

## 🎯 Day 1：环境搭建（全员）

### 上午（09:00-12:00）

#### Step 1: 安装宝塔面板（工程师A）

```bash
# 1. SSH连接到服务器
ssh root@你的服务器IP

# 2. 安装宝塔面板（CentOS 7）
yum install -y wget && wget -O install.sh http://download.bt.cn/install/install_6.0.sh && sh install.sh

# 3. 记录宝塔面板地址和账号密码
# 面板地址: http://你的IP:8888/xxxxxxxx
# 用户名: xxxxxxxx
# 密码: xxxxxxxx

# 4. 登录宝塔面板
# 浏览器打开面板地址，输入账号密码
```

#### Step 2: 安装软件（工程师A）

在宝塔面板中安装：

```
☑ Nginx 1.22
☑ MySQL 8.0
☑ Redis 7.0
☑ PM2管理器
☑ Node.js 18.x
```

**预计耗时：** 30-60分钟（自动安装）

#### Step 3: 创建数据库（工程师A）

1. 宝塔面板 → 数据库 → 添加数据库
2. 填写：
   ```
   数据库名：momo_novel_db
   用户名：toefl_user
   密码：mojz168168
   ```
3. 提交

#### Step 4: 本地开发环境（工程师B、C）

**安装必要软件：**

```bash
# 1. 安装Node.js 18.x
# 访问 https://nodejs.org/
# 下载并安装 LTS版本

# 2. 验证安装
node -v  # 应显示 v18.x.x
npm -v   # 应显示 9.x.x

# 3. 安装全局工具
npm install -g typescript ts-node pnpm

# 4. 配置npm国内镜像（可选）
npm config set registry https://registry.npmmirror.com
```

**安装开发工具：**

- [ ] VS Code（推荐）
- [ ] Git
- [ ] Postman（API测试）
- [ ] MySQL Workbench（数据库管理，可选）

**VS Code插件：**

```
必装插件：
- Vue Language Features (Volar)
- TypeScript Vue Plugin (Volar)
- ESLint
- Prettier
- Prisma

推荐插件：
- GitLens
- Auto Rename Tag
- Path Intellisense
- REST Client
```

---

### 下午（13:30-18:00）

#### Step 5: 创建项目结构（工程师A）

```bash
# 1. 创建项目根目录
mkdir momo-novel-v2
cd momo-novel-v2

# 2. 初始化Git仓库
git init
git remote add origin <你的仓库地址>

# 3. 创建 .gitignore
cat > .gitignore << 'EOF'
# 依赖
node_modules/
.pnp
.pnp.js

# 测试
coverage/

# 生产
dist/
build/

# 环境变量
.env
.env.local
.env.production

# 日志
logs/
*.log
npm-debug.log*

# IDE
.vscode/
.idea/
*.swp
*.swo

# OS
.DS_Store
Thumbs.db

# Prisma
prisma/migrations/*_*
EOF

# 4. 创建项目结构
mkdir -p frontend backend docs scripts
```

#### Step 6: 初始化前端项目（工程师B）

```bash
# 1. 创建Vue 3项目
cd frontend
npm create vite@latest . -- --template vue-ts

# 2. 安装依赖
npm install

# 3. 安装UI框架
npm install element-plus @element-plus/icons-vue

# 4. 安装Tailwind CSS
npm install -D tailwindcss postcss autoprefixer
npx tailwindcss init -p

# 5. 安装其他依赖
npm install vue-router pinia axios
npm install @vueuse/core  # Vue组合式工具库

# 6. 安装开发依赖
npm install -D @types/node
npm install -D eslint prettier
npm install -D vitest @vue/test-utils

# 7. 启动开发服务器测试
npm run dev
# 访问 http://localhost:5188
```

**配置Tailwind CSS：**

```javascript
// tailwind.config.js
/** @type {import('tailwindcss').Config} */
export default {
  content: [
    "./index.html",
    "./src/**/*.{vue,js,ts,jsx,tsx}",
  ],
  theme: {
    extend: {
      colors: {
        'xhs-red': '#FE2C55',
        'beige': '#F5E6D3',
        'beige-light': '#FAF5F0',
      }
    },
  },
  plugins: [],
}
```

```css
/* src/assets/style.css */
@tailwind base;
@tailwind components;
@tailwind utilities;
```

#### Step 7: 初始化后端项目（工程师C）

```bash
# 1. 进入后端目录
cd ../backend

# 2. 初始化package.json
npm init -y

# 3. 安装核心依赖
npm install fastify @fastify/cors @fastify/jwt @fastify/multipart
npm install @prisma/client bcrypt jsonwebtoken
npm install dotenv ioredis

# 4. 安装开发依赖
npm install -D typescript @types/node ts-node nodemon
npm install -D prisma
npm install -D @types/bcrypt @types/jsonwebtoken

# 5. 初始化TypeScript
npx tsc --init

# 6. 初始化Prisma
npx prisma init

# 7. 创建项目结构
mkdir -p src/{controllers,services,routes,middlewares,utils,types}
mkdir -p tests/{unit,integration}
mkdir -p scripts
```

**配置package.json：**

```json
{
  "name": "momo-novel-backend",
  "version": "1.0.0",
  "scripts": {
    "dev": "nodemon --exec ts-node src/server.ts",
    "build": "tsc",
    "start": "node dist/server.js",
    "prisma:generate": "prisma generate",
    "prisma:migrate": "prisma migrate dev",
    "prisma:studio": "prisma studio",
    "test": "vitest"
  }
}
```

**配置tsconfig.json：**

```json
{
  "compilerOptions": {
    "target": "ES2020",
    "module": "commonjs",
    "lib": ["ES2020"],
    "outDir": "./dist",
    "rootDir": "./src",
    "strict": true,
    "esModuleInterop": true,
    "skipLibCheck": true,
    "forceConsistentCasingInFileNames": true,
    "resolveJsonModule": true,
    "moduleResolution": "node",
    "baseUrl": ".",
    "paths": {
      "@/*": ["src/*"]
    }
  },
  "include": ["src/**/*"],
  "exclude": ["node_modules", "dist"]
}
```

#### Step 8: 配置Prisma Schema（工程师C）

```prisma
// prisma/schema.prisma
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

// 用户表（简化版，先测试连接）
model User {
  id        Int      @id @default(autoincrement())
  username  String   @unique @db.VarChar(50)
  email     String   @unique @db.VarChar(100)
  password  String   @db.VarChar(255)
  createdAt DateTime @default(now()) @db.DateTime(0)
  updatedAt DateTime @updatedAt @db.DateTime(0)

  @@map("users")
}
```

**配置.env：**

```bash
# backend/.env
NODE_ENV=development
PORT=3000

# 数据库连接（使用你的服务器IP）
DATABASE_URL="mysql://toefl_user:mojz168168@localhost:3306/momo_novel_db"

# 如果在本地开发，连接远程数据库：
# DATABASE_URL="mysql://toefl_user:mojz168168@你的服务器IP:3306/momo_novel_db"

JWT_SECRET=your-super-secret-key-change-in-production

REDIS_HOST=localhost
REDIS_PORT=6379
```

**测试数据库连接：**

```bash
# 生成Prisma Client
npx prisma generate

# 创建数据库表
npx prisma db push

# 打开Prisma Studio查看数据库
npx prisma studio
# 访问 http://localhost:5555
```

#### Step 9: 创建基础服务器（工程师C）

```typescript
// src/server.ts
import Fastify from 'fastify'
import cors from '@fastify/cors'
import { PrismaClient } from '@prisma/client'

const fastify = Fastify({
  logger: true
})

const prisma = new PrismaClient()

// 注册CORS
fastify.register(cors, {
  origin: true
})

// 健康检查
fastify.get('/api/health', async (request, reply) => {
  return { 
    status: 'ok',
    timestamp: new Date().toISOString()
  }
})

// 测试数据库连接
fastify.get('/api/test-db', async (request, reply) => {
  try {
    const userCount = await prisma.user.count()
    return {
      success: true,
      message: '数据库连接成功',
      userCount
    }
  } catch (error: any) {
    return {
      success: false,
      message: '数据库连接失败',
      error: error.message
    }
  }
})

// 启动服务器
const start = async () => {
  try {
    await fastify.listen({ 
      port: Number(process.env.PORT) || 3000,
      host: '0.0.0.0'
    })
    console.log(`🚀 Server is running on http://localhost:3000`)
  } catch (err) {
    fastify.log.error(err)
    process.exit(1)
  }
}

start()
```

**启动测试：**

```bash
# 启动后端服务
npm run dev

# 在另一个终端测试
curl http://localhost:3000/api/health
curl http://localhost:3000/api/test-db
```

---

## 🎉 Day 1 完成检查清单

### 服务器环境（工程师A）

- [ ] ✅ 宝塔面板安装成功
- [ ] ✅ Nginx、MySQL、Redis已安装
- [ ] ✅ 数据库创建成功
- [ ] ✅ 数据库可远程连接

### 前端环境（工程师B）

- [ ] ✅ Vue 3项目创建成功
- [ ] ✅ 开发服务器可启动
- [ ] ✅ Tailwind CSS配置完成
- [ ] ✅ Element Plus可用

### 后端环境（工程师C）

- [ ] ✅ Fastify项目创建成功
- [ ] ✅ Prisma连接数据库成功
- [ ] ✅ 服务器可启动
- [ ] ✅ API接口可访问

### 团队协作

- [ ] ✅ Git仓库创建
- [ ] ✅ 代码已提交
- [ ] ✅ 沟通群建立
- [ ] ✅ 任务分工明确

---

## 🚀 Day 2：开始开发

### 晨会（09:00-09:30）

**工程师A：**
- 今天完成认证中间件
- 设计API接口规范
- 评审其他人的代码

**工程师B：**
- 今天完成登录注册页面
- 开发公共组件
- 配置路由系统

**工程师C：**
- 今天完成用户注册登录API
- 数据库表结构完善
- 编写API文档

### 并行开发

```
09:30-12:00  专注开发
12:00-13:30  午休
13:30-17:00  继续开发 + 联调
17:00-17:30  代码评审 + 提交
```

---

## 📚 常用命令速查

### 前端（工程师B）

```bash
# 开发
npm run dev          # 启动开发服务器
npm run build        # 生产构建
npm run preview      # 预览生产构建

# 测试
npm run test         # 运行测试
npm run test:ui      # 测试UI界面

# 代码检查
npm run lint         # ESLint检查
npm run format       # Prettier格式化
```

### 后端（工程师C）

```bash
# 开发
npm run dev          # 启动开发服务器
npm run build        # TypeScript编译
npm start            # 启动生产服务器

# 数据库
npx prisma generate  # 生成Prisma Client
npx prisma migrate dev  # 创建迁移
npx prisma db push   # 同步数据库（开发）
npx prisma studio    # 打开数据库管理界面

# 测试
npm test             # 运行测试
```

### Git操作

```bash
# 拉取最新代码
git pull origin main

# 创建功能分支
git checkout -b feature/用户登录

# 提交代码
git add .
git commit -m "feat: 完成用户登录功能"
git push origin feature/用户登录

# 合并到主分支
git checkout main
git merge feature/用户登录
git push origin main
```

---

## 🆘 常见问题解决

### Q1: 数据库连接失败

```bash
# 检查MySQL是否启动
# 宝塔面板 → 软件商店 → MySQL → 设置 → 服务状态

# 检查端口是否开放
# 宝塔面板 → 安全 → 放行端口3306

# 检查DATABASE_URL是否正确
# backend/.env
```

### Q2: 前端无法访问后端API

```bash
# 检查后端是否启动
# 访问 http://localhost:3000/api/health

# 检查CORS配置
# src/server.ts 中的 cors 配置

# 检查防火墙
```

### Q3: Prisma Client生成失败

```bash
# 删除node_modules和package-lock.json
rm -rf node_modules package-lock.json

# 重新安装
npm install

# 重新生成
npx prisma generate
```

### Q4: TypeScript报错

```bash
# 检查tsconfig.json配置
# 安装缺失的类型定义
npm install -D @types/node

# 重启VS Code的TypeScript服务
# VS Code: Ctrl+Shift+P → TypeScript: Restart TS Server
```

---

## 📞 团队联系方式

**工程师A（Leader）：**
- 微信/电话：____________
- 负责：架构、核心模块、疑难问题

**工程师B（前端）：**
- 微信/电话：____________
- 负责：所有前端页面和组件

**工程师C（后端）：**
- 微信/电话：____________
- 负责：所有后端API和数据库

**微信群：** ____________

---

## 🎯 下一步

Day 1完成后，参考：
- 📄 `三人团队重构实施计划_宝塔MySQL版.md` - 完整8周计划
- 📄 `技术重构深度分析方案.md` - 技术细节

**开始行动吧！** 🚀

