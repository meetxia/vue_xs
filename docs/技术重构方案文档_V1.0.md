# ğŸ“˜ å°è¯´å¹³å°æŠ€æœ¯é‡æ„æ–¹æ¡ˆæ–‡æ¡£ V1.0

> **é¡¹ç›®ä»£å·**: Phoenix (å‡¤å‡°æ¶…æ§ƒ)  
> **ç¼–å†™æ—¥æœŸ**: 2025-10-26  
> **éƒ¨ç½²ç¯å¢ƒ**: é˜¿é‡Œäº‘ Linux + å®å¡”é¢æ¿ + MySQL  
> **ç›®æ ‡**: ä»ä¼ ç»Ÿæ¶æ„å‡çº§åˆ°ç°ä»£åŒ–å…¨æ ˆåº”ç”¨  

---

## ğŸ“‘ ç›®å½•

1. [é¡¹ç›®èƒŒæ™¯](#1-é¡¹ç›®èƒŒæ™¯)
2. [ç°çŠ¶åˆ†æ](#2-ç°çŠ¶åˆ†æ)
3. [æŠ€æœ¯é€‰å‹](#3-æŠ€æœ¯é€‰å‹)
4. [æ¶æ„è®¾è®¡](#4-æ¶æ„è®¾è®¡)
5. [æ•°æ®åº“è®¾è®¡](#5-æ•°æ®åº“è®¾è®¡)
6. [éƒ¨ç½²æ–¹æ¡ˆ](#6-éƒ¨ç½²æ–¹æ¡ˆ)
7. [å¼€å‘è§„èŒƒ](#7-å¼€å‘è§„èŒƒ)
8. [é£é™©è¯„ä¼°](#8-é£é™©è¯„ä¼°)
9. [é¡¹ç›®æ’æœŸ](#9-é¡¹ç›®æ’æœŸ)

---

## 1. é¡¹ç›®èƒŒæ™¯

### 1.1 å½“å‰é¡¹ç›®æ¦‚å†µ

**é¡¹ç›®åç§°**: MOMOç‚’é¥­åº—å°è¯´å¹³å°  
**å½“å‰ç‰ˆæœ¬**: V2.5.0  
**æŠ€æœ¯å€ºåŠ¡ç­‰çº§**: âš ï¸ ä¸­é«˜

**æ ¸å¿ƒåŠŸèƒ½**:
- âœ… å°è¯´å‘å¸ƒä¸ç®¡ç†
- âœ… ç”¨æˆ·è®¤è¯ç³»ç»Ÿ
- âœ… ç€‘å¸ƒæµå±•ç¤º
- âœ… ç‚¹èµæ”¶è—åŠŸèƒ½
- âœ… ç®¡ç†åå°

### 1.2 é‡æ„å¿…è¦æ€§

#### ğŸš¨ ç´§æ€¥é—®é¢˜
1. **æ•°æ®å±‚é£é™©** - JSONæ–‡ä»¶å­˜å‚¨ï¼Œå¹¶å‘å®‰å…¨éšæ‚£
2. **å¯æ‰©å±•æ€§å·®** - æ¶æ„ä¸æ”¯æŒé«˜å¹¶å‘
3. **ç»´æŠ¤æˆæœ¬é«˜** - å¤§é‡é‡å¤ä»£ç 

#### ğŸ¯ ä¸šåŠ¡ç›®æ ‡
1. æ”¯æŒ **10ä¸‡+** æ—¥æ´»ç”¨æˆ·
2. å“åº”æ—¶é—´ < **200ms**
3. SEOæ’åè¿›å…¥å‰**3é¡µ**
4. ä»£ç å¯ç»´æŠ¤æ€§æå‡ **80%**

---

## 2. ç°çŠ¶åˆ†æ

### 2.1 æŠ€æœ¯æ ˆç°çŠ¶

| åˆ†ç±» | å½“å‰æŠ€æœ¯ | è¯„åˆ† | é—®é¢˜ |
|------|---------|------|------|
| åç«¯æ¡†æ¶ | Express.js | 6/10 | æ— ç±»å‹å®‰å…¨ |
| å‰ç«¯ | åŸç”ŸJS + HTML | 4/10 | æ— ç»„ä»¶åŒ– |
| æ ·å¼ | Tailwind CDN | 5/10 | ç”Ÿäº§ç¯å¢ƒä¸æ¨è |
| æ•°æ®åº“ | JSONæ–‡ä»¶ | 2/10 | âŒ ä¸¥é‡éšæ‚£ |
| éƒ¨ç½² | PM2 | 6/10 | æ— CI/CD |
| ç›‘æ§ | âŒ æ—  | 0/10 | ç›²é£çŠ¶æ€ |

### 2.2 ä»£ç è´¨é‡åˆ†æ

```javascript
// âŒ é—®é¢˜ç¤ºä¾‹ 1: ç±»å‹ä¸å®‰å…¨
function createNovel(data) {
  // è¿è¡Œæ—¶æ‰èƒ½å‘ç° data.title ä¸å­˜åœ¨
  const novel = {
    id: Date.now(),
    title: data.title,
    // ...
  }
}

// âŒ é—®é¢˜ç¤ºä¾‹ 2: å¹¶å‘å®‰å…¨
const data = JSON.parse(fs.readFileSync('novels.json'))
data.novels.push(newNovel)
fs.writeFileSync('novels.json', JSON.stringify(data))
// ä¸¤ä¸ªè¯·æ±‚åŒæ—¶å†™å…¥ â†’ æ•°æ®ä¸¢å¤±

// âŒ é—®é¢˜ç¤ºä¾‹ 3: ä»£ç é‡å¤
// admin.html, index.html, read.html é‡å¤å¯¼èˆªæ ä»£ç  300+ è¡Œ
```

### 2.3 æ€§èƒ½é—®é¢˜

| æŒ‡æ ‡ | å½“å‰ | ç›®æ ‡ | å·®è· |
|------|------|------|------|
| é¦–å±åŠ è½½ | 2.5s | 0.8s | -68% |
| APIå“åº” | 300ms | 100ms | -67% |
| LCP | 3.2s | 1.5s | -53% |
| FID | 200ms | 50ms | -75% |

---

## 3. æŠ€æœ¯é€‰å‹

### 3.1 æœ€ç»ˆæŠ€æœ¯æ ˆ â­

```yaml
æ¶æ„æ¨¡å¼: å…¨æ ˆä¸€ä½“åŒ– SSR/SSG æ··åˆæ¸²æŸ“
æ¡†æ¶: Next.js 15 (App Router)
è¯­è¨€: TypeScript 5.3+
UIæ¡†æ¶: React 19
æ ·å¼æ–¹æ¡ˆ: Tailwind CSS 4 + shadcn/ui
ORM: Prisma 5.x
æ•°æ®åº“: MySQL 8.0 (é˜¿é‡Œäº‘RDS æ¨è)
è®¤è¯: NextAuth.js v5
çŠ¶æ€ç®¡ç†: Zustand + React Server Components
éƒ¨ç½²: PM2 + Nginx (å®å¡”é¢æ¿)
CI/CD: GitHub Actions â†’ é˜¿é‡Œäº‘
ç›‘æ§: å®å¡”è‡ªå¸¦ + è‡ªå®šä¹‰æ—¥å¿—
```

### 3.2 æŠ€æœ¯é€‰å‹ç†ç”±

#### ğŸ”¥ Next.js 15 (ä¸ºä»€ä¹ˆä¸ç”¨ Vue/Nuxt?)

**å…³é”®ä¼˜åŠ¿**:
```typescript
// âœ… æœåŠ¡ç«¯ç»„ä»¶ - é›¶å®¢æˆ·ç«¯JS
export default async function NovelsPage() {
  // ç›´æ¥åœ¨ç»„ä»¶å†…æŸ¥è¯¢æ•°æ®åº“ - æ— éœ€APIå±‚
  const novels = await prisma.novel.findMany({
    where: { status: 'PUBLISHED' },
    orderBy: { publishTime: 'desc' },
    take: 20
  })
  
  return <NovelGrid novels={novels} />
}

// âœ… è‡ªåŠ¨ä»£ç åˆ†å‰² - æŒ‰éœ€åŠ è½½
// âœ… å›¾ç‰‡ä¼˜åŒ– - è‡ªåŠ¨WebPè½¬æ¢
// âœ… å­—ä½“ä¼˜åŒ– - è‡ªæ‰˜ç®¡Google Fonts
```

**å¯¹æ¯” Vue/Nuxt**:
| ç‰¹æ€§ | Next.js | Nuxt | èƒœè€… |
|------|---------|------|------|
| Server Components | âœ… æˆç†Ÿ | âš ï¸ å®éªŒæ€§ | Next.js |
| ç±»å‹æ¨å¯¼ | âœ… å®Œç¾ | âœ… è‰¯å¥½ | Next.js |
| ç”Ÿæ€ä¸°å¯Œåº¦ | 10/10 | 8/10 | Next.js |
| å­¦ä¹ æ›²çº¿ | ä¸­ç­‰ | è¾ƒä½ | Nuxt |
| æ€§èƒ½ | 9.5/10 | 9/10 | Next.js |

#### ğŸ—„ï¸ Prisma + MySQL (ä¸ºä»€ä¹ˆä¸ç”¨ Mongoose?)

```typescript
// âœ… Prisma - ç±»å‹å®‰å…¨ + è‡ªåŠ¨è¿ç§»
const novel = await prisma.novel.findUnique({
  where: { id: 1 },
  include: {
    author: true,
    comments: { take: 10 },
    tags: true
  }
})
// novel çš„ç±»å‹å®Œå…¨è‡ªåŠ¨æ¨å¯¼ - é›¶é”™è¯¯ï¼

// âŒ ä¼ ç»ŸORM - è¿è¡Œæ—¶æ‰å‘ç°é”™è¯¯
const novel = await Novel.findById(1).populate('author')
// ç±»å‹æ˜¯ any - åˆ°å¤„æ˜¯ bug
```

**MySQL vs PostgreSQL**:
- âœ… é˜¿é‡Œäº‘ RDS MySQL æˆç†Ÿç¨³å®š
- âœ… å®å¡”é¢æ¿åŸç”Ÿæ”¯æŒ
- âœ… å›¢é˜Ÿç†Ÿæ‚‰åº¦é«˜
- âš ï¸ PostgreSQL åŠŸèƒ½æ›´å¼ºä½†é…ç½®å¤æ‚

#### ğŸ¨ Tailwind + shadcn/ui

```tsx
// âœ… ä¸€æ¬¡ç¼–å†™ï¼Œåˆ°å¤„å¤ç”¨
import { Button } from "@/components/ui/button"
import { Card } from "@/components/ui/card"

<Card className="hover:shadow-lg transition-shadow">
  <CardHeader>
    <CardTitle>{novel.title}</CardTitle>
  </CardHeader>
  <CardContent>
    <p className="line-clamp-3">{novel.summary}</p>
  </CardContent>
  <CardFooter>
    <Button variant="outline">é˜…è¯»</Button>
  </CardFooter>
</Card>
```

### 3.3 æŠ€æœ¯æ ˆä¾èµ–æ ‘

```
â”Œâ”€ Next.js 15.0.x
â”‚  â”œâ”€ React 19.x
â”‚  â”œâ”€ TypeScript 5.3.x
â”‚  â””â”€ React Server Components
â”‚
â”œâ”€ Prisma 5.x
â”‚  â”œâ”€ @prisma/client
â”‚  â””â”€ prisma (dev)
â”‚
â”œâ”€ UI å±‚
â”‚  â”œâ”€ tailwindcss 4.x
â”‚  â”œâ”€ shadcn/ui
â”‚  â”œâ”€ radix-ui
â”‚  â””â”€ lucide-react (å›¾æ ‡)
â”‚
â”œâ”€ è®¤è¯
â”‚  â”œâ”€ next-auth 5.x
â”‚  â””â”€ bcryptjs
â”‚
â”œâ”€ çŠ¶æ€ç®¡ç†
â”‚  â”œâ”€ zustand (å®¢æˆ·ç«¯çŠ¶æ€)
â”‚  â””â”€ react-query (å¯é€‰)
â”‚
â””â”€ å·¥å…·åº“
   â”œâ”€ zod (è¿è¡Œæ—¶éªŒè¯)
   â”œâ”€ date-fns (æ—¥æœŸå¤„ç†)
   â””â”€ sharp (å›¾ç‰‡å¤„ç†)
```

---

## 4. æ¶æ„è®¾è®¡

### 4.1 ç³»ç»Ÿæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       é˜¿é‡Œäº‘ ECS                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚            å®å¡”é¢æ¿ (ç®¡ç†å±‚)                      â”‚    â”‚
â”‚  â”‚  - Nginx é…ç½®                                    â”‚    â”‚
â”‚  â”‚  - SSL è¯ä¹¦                                      â”‚    â”‚
â”‚  â”‚  - è¿›ç¨‹ç›‘æ§                                      â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                          â†“                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚         Nginx (åå‘ä»£ç† + è´Ÿè½½å‡è¡¡)              â”‚    â”‚
â”‚  â”‚  - Gzip å‹ç¼©                                     â”‚    â”‚
â”‚  â”‚  - é™æ€èµ„æºç¼“å­˜                                  â”‚    â”‚
â”‚  â”‚  - Rate Limiting                                 â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                          â†“                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚         PM2 (è¿›ç¨‹ç®¡ç†)                           â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚    â”‚
â”‚  â”‚  â”‚  Next.js Server (Port 3000)          â”‚      â”‚    â”‚
â”‚  â”‚  â”‚  - App Router                        â”‚      â”‚    â”‚
â”‚  â”‚  â”‚  - Server Components                 â”‚      â”‚    â”‚
â”‚  â”‚  â”‚  - API Routes                        â”‚      â”‚    â”‚
â”‚  â”‚  â”‚  - Middleware                        â”‚      â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚    â”‚
â”‚  â”‚  Instances: 4 (CPUæ ¸å¿ƒæ•°-1)                     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                          â†“                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚         Prisma Client (æ•°æ®å±‚)                   â”‚    â”‚
â”‚  â”‚  - Connection Pooling (è¿æ¥æ± )                  â”‚    â”‚
â”‚  â”‚  - Query Caching                                â”‚    â”‚
â”‚  â”‚  - Prepared Statements                          â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                          â†“                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚   MySQL 8.0            â”‚
              â”‚   (æœ¬åœ° or é˜¿é‡Œäº‘RDS)    â”‚
              â”‚   - InnoDB å¼•æ“         â”‚
              â”‚   - UTF8MB4 ç¼–ç         â”‚
              â”‚   - ä¸»ä»å¤åˆ¶(å¯é€‰)       â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 Next.js åº”ç”¨æ¶æ„

```
novel-platform/
â”œâ”€â”€ app/                                    # Next.js 15 App Router
â”‚   â”œâ”€â”€ (auth)/                            # è®¤è¯è·¯ç”±ç»„ï¼ˆç‹¬ç«‹å¸ƒå±€ï¼‰
â”‚   â”‚   â”œâ”€â”€ login/
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx                   # ç™»å½•é¡µ
â”‚   â”‚   â”œâ”€â”€ register/
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx                   # æ³¨å†Œé¡µ
â”‚   â”‚   â””â”€â”€ layout.tsx                     # è®¤è¯é¡µé¢å¸ƒå±€
â”‚   â”‚
â”‚   â”œâ”€â”€ (main)/                            # ä¸»ç«™è·¯ç”±ç»„
â”‚   â”‚   â”œâ”€â”€ page.tsx                       # é¦–é¡µï¼ˆSSRï¼‰
â”‚   â”‚   â”œâ”€â”€ novels/
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx                   # å°è¯´åˆ—è¡¨ï¼ˆSSR + ISRï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ [id]/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx               # å°è¯´è¯¦æƒ…ï¼ˆSSGï¼‰
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ read/
â”‚   â”‚   â”‚   â”‚       â””â”€â”€ page.tsx           # é˜…è¯»é¡µï¼ˆSSRï¼‰
â”‚   â”‚   â”‚   â””â”€â”€ loading.tsx                # åŠ è½½çŠ¶æ€
â”‚   â”‚   â”œâ”€â”€ profile/
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx                   # ç”¨æˆ·ä¸­å¿ƒï¼ˆSSRï¼‰
â”‚   â”‚   â”œâ”€â”€ search/
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx                   # æœç´¢é¡µï¼ˆCSRï¼‰
â”‚   â”‚   â””â”€â”€ layout.tsx                     # ä¸»ç«™å¸ƒå±€
â”‚   â”‚
â”‚   â”œâ”€â”€ admin/                             # ç®¡ç†åå°
â”‚   â”‚   â”œâ”€â”€ layout.tsx                     # åå°å¸ƒå±€
â”‚   â”‚   â”œâ”€â”€ page.tsx                       # ä»ªè¡¨ç›˜
â”‚   â”‚   â”œâ”€â”€ novels/
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx                   # å°è¯´ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ [id]/edit/page.tsx         # ç¼–è¾‘å°è¯´
â”‚   â”‚   â”‚   â””â”€â”€ new/page.tsx               # æ–°å»ºå°è¯´
â”‚   â”‚   â”œâ”€â”€ users/
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx                   # ç”¨æˆ·ç®¡ç†
â”‚   â”‚   â””â”€â”€ settings/
â”‚   â”‚       â””â”€â”€ page.tsx                   # ç³»ç»Ÿè®¾ç½®
â”‚   â”‚
â”‚   â”œâ”€â”€ api/                               # API è·¯ç”±ï¼ˆæŒ‰éœ€ï¼‰
â”‚   â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â”‚   â””â”€â”€ [...nextauth]/route.ts    # NextAuth é…ç½®
â”‚   â”‚   â”œâ”€â”€ novels/
â”‚   â”‚   â”‚   â”œâ”€â”€ route.ts                   # å°è¯´CRUD
â”‚   â”‚   â”‚   â””â”€â”€ [id]/
â”‚   â”‚   â”‚       â”œâ”€â”€ route.ts               # å•ä¸ªå°è¯´æ“ä½œ
â”‚   â”‚   â”‚       â””â”€â”€ like/route.ts          # ç‚¹èµ
â”‚   â”‚   â”œâ”€â”€ upload/
â”‚   â”‚   â”‚   â””â”€â”€ route.ts                   # æ–‡ä»¶ä¸Šä¼ 
â”‚   â”‚   â””â”€â”€ health/
â”‚   â”‚       â””â”€â”€ route.ts                   # å¥åº·æ£€æŸ¥
â”‚   â”‚
â”‚   â”œâ”€â”€ layout.tsx                         # æ ¹å¸ƒå±€
â”‚   â”œâ”€â”€ loading.tsx                        # å…¨å±€åŠ è½½
â”‚   â”œâ”€â”€ error.tsx                          # å…¨å±€é”™è¯¯
â”‚   â”œâ”€â”€ not-found.tsx                      # 404é¡µé¢
â”‚   â””â”€â”€ globals.css                        # å…¨å±€æ ·å¼
â”‚
â”œâ”€â”€ components/                            # ç»„ä»¶åº“
â”‚   â”œâ”€â”€ ui/                               # shadcn/ui åŸºç¡€ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ button.tsx
â”‚   â”‚   â”œâ”€â”€ card.tsx
â”‚   â”‚   â”œâ”€â”€ dialog.tsx
â”‚   â”‚   â”œâ”€â”€ input.tsx
â”‚   â”‚   â””â”€â”€ ... (30+ ç»„ä»¶)
â”‚   â”‚
â”‚   â”œâ”€â”€ novels/                           # å°è¯´ç›¸å…³ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ NovelCard.tsx                 # å°è¯´å¡ç‰‡
â”‚   â”‚   â”œâ”€â”€ NovelGrid.tsx                 # ç€‘å¸ƒæµç½‘æ ¼
â”‚   â”‚   â”œâ”€â”€ NovelReader.tsx               # é˜…è¯»å™¨
â”‚   â”‚   â”œâ”€â”€ NovelStats.tsx                # ç»Ÿè®¡ä¿¡æ¯
â”‚   â”‚   â””â”€â”€ NovelFilters.tsx              # ç­›é€‰å™¨
â”‚   â”‚
â”‚   â”œâ”€â”€ layout/                           # å¸ƒå±€ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ Header.tsx                    # é¡¶éƒ¨å¯¼èˆª
â”‚   â”‚   â”œâ”€â”€ Footer.tsx                    # åº•éƒ¨
â”‚   â”‚   â”œâ”€â”€ Sidebar.tsx                   # ä¾§è¾¹æ 
â”‚   â”‚   â””â”€â”€ MobileNav.tsx                 # ç§»åŠ¨å¯¼èˆª
â”‚   â”‚
â”‚   â”œâ”€â”€ editor/                           # ç¼–è¾‘å™¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ RichTextEditor.tsx            # å¯Œæ–‡æœ¬ç¼–è¾‘å™¨
â”‚   â”‚   â”œâ”€â”€ MarkdownEditor.tsx            # Markdownç¼–è¾‘å™¨
â”‚   â”‚   â””â”€â”€ ImageUpload.tsx               # å›¾ç‰‡ä¸Šä¼ 
â”‚   â”‚
â”‚   â””â”€â”€ admin/                            # ç®¡ç†åå°ç»„ä»¶
â”‚       â”œâ”€â”€ DataTable.tsx                 # æ•°æ®è¡¨æ ¼
â”‚       â”œâ”€â”€ StatsCard.tsx                 # ç»Ÿè®¡å¡ç‰‡
â”‚       â””â”€â”€ Chart.tsx                     # å›¾è¡¨
â”‚
â”œâ”€â”€ lib/                                  # æ ¸å¿ƒåº“
â”‚   â”œâ”€â”€ prisma.ts                        # Prisma å®¢æˆ·ç«¯å•ä¾‹
â”‚   â”œâ”€â”€ auth.ts                          # è®¤è¯é…ç½®
â”‚   â”œâ”€â”€ db/                              # æ•°æ®åº“æ“ä½œå±‚
â”‚   â”‚   â”œâ”€â”€ novels.ts                    # å°è¯´ç›¸å…³æŸ¥è¯¢
â”‚   â”‚   â”œâ”€â”€ users.ts                     # ç”¨æˆ·ç›¸å…³æŸ¥è¯¢
â”‚   â”‚   â””â”€â”€ comments.ts                  # è¯„è®ºç›¸å…³æŸ¥è¯¢
â”‚   â”œâ”€â”€ utils/                           # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ cn.ts                        # className åˆå¹¶
â”‚   â”‚   â”œâ”€â”€ format.ts                    # æ ¼å¼åŒ–å‡½æ•°
â”‚   â”‚   â””â”€â”€ validation.ts                # éªŒè¯å‡½æ•°
â”‚   â””â”€â”€ hooks/                           # è‡ªå®šä¹‰ Hooks
â”‚       â”œâ”€â”€ useUser.ts                   # ç”¨æˆ·çŠ¶æ€
â”‚       â””â”€â”€ useNovel.ts                  # å°è¯´æ•°æ®
â”‚
â”œâ”€â”€ prisma/
â”‚   â”œâ”€â”€ schema.prisma                    # æ•°æ®æ¨¡å‹å®šä¹‰
â”‚   â”œâ”€â”€ seed.ts                          # ç§å­æ•°æ®
â”‚   â””â”€â”€ migrations/                      # æ•°æ®åº“è¿ç§»
â”‚       â””â”€â”€ 20251026_init/
â”‚           â””â”€â”€ migration.sql
â”‚
â”œâ”€â”€ public/                              # é™æ€èµ„æº
â”‚   â”œâ”€â”€ images/
â”‚   â”œâ”€â”€ fonts/
â”‚   â””â”€â”€ favicon.ico
â”‚
â”œâ”€â”€ types/                               # TypeScript ç±»å‹
â”‚   â”œâ”€â”€ novel.ts
â”‚   â”œâ”€â”€ user.ts
â”‚   â””â”€â”€ api.ts
â”‚
â”œâ”€â”€ config/                              # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ site.ts                         # ç½‘ç«™é…ç½®
â”‚   â””â”€â”€ constants.ts                    # å¸¸é‡å®šä¹‰
â”‚
â”œâ”€â”€ middleware.ts                        # Next.js ä¸­é—´ä»¶
â”œâ”€â”€ next.config.js                       # Next.js é…ç½®
â”œâ”€â”€ tailwind.config.ts                   # Tailwind é…ç½®
â”œâ”€â”€ tsconfig.json                        # TypeScript é…ç½®
â”œâ”€â”€ .env.local                           # ç¯å¢ƒå˜é‡ï¼ˆæœ¬åœ°ï¼‰
â”œâ”€â”€ .env.production                      # ç¯å¢ƒå˜é‡ï¼ˆç”Ÿäº§ï¼‰
â”œâ”€â”€ ecosystem.config.js                  # PM2 é…ç½®
â””â”€â”€ package.json
```

### 4.3 æ¸²æŸ“ç­–ç•¥

| é¡µé¢ç±»å‹ | æ¸²æŸ“æ–¹å¼ | åŸå›  | ç¼“å­˜ç­–ç•¥ |
|---------|---------|------|---------|
| é¦–é¡µ | SSR | å®æ—¶æ•°æ® | CDN 10ç§’ |
| å°è¯´åˆ—è¡¨ | ISR | å‡†å®æ—¶ | 60ç§’é‡æ–°ç”Ÿæˆ |
| å°è¯´è¯¦æƒ… | SSG | é™æ€åŒ– | æŒ‰éœ€é‡æ–°éªŒè¯ |
| é˜…è¯»é¡µ | SSR | éœ€è®¤è¯ | æ— ç¼“å­˜ |
| æœç´¢é¡µ | CSR | äº¤äº’é¢‘ç¹ | å®¢æˆ·ç«¯ç¼“å­˜ |
| ç”¨æˆ·ä¸­å¿ƒ | SSR | ç§å¯†æ•°æ® | æ— ç¼“å­˜ |
| ç®¡ç†åå° | CSR | é¢‘ç¹æ“ä½œ | æ— ç¼“å­˜ |

```typescript
// ç¤ºä¾‹ï¼šå°è¯´åˆ—è¡¨é¡µï¼ˆISRï¼‰
export const revalidate = 60 // 60ç§’é‡æ–°ç”Ÿæˆ

export default async function NovelsPage() {
  const novels = await prisma.novel.findMany({
    where: { status: 'PUBLISHED' },
    orderBy: { publishTime: 'desc' },
    take: 20,
    include: {
      author: { select: { username: true, avatar: true } },
      _count: { select: { comments: true, likes: true } }
    }
  })
  
  return <NovelGrid novels={novels} />
}
```

---

## 5. æ•°æ®åº“è®¾è®¡

### 5.1 Prisma Schema å®šä¹‰

```prisma
// prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
  previewFeatures = ["fullTextSearch", "fullTextIndex"] // MySQLå…¨æ–‡æœç´¢
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
  relationMode = "prisma" // å…¼å®¹æ— å¤–é”®æ¨¡å¼
}

// ============= ç”¨æˆ·æ¨¡å— =============

enum UserRole {
  USER      // æ™®é€šç”¨æˆ·
  ADMIN     // ç®¡ç†å‘˜
  AUTHOR    // ä½œè€…
}

enum UserStatus {
  ACTIVE    // æ¿€æ´»
  BANNED    // å°ç¦
  PENDING   // å¾…å®¡æ ¸
}

model User {
  id            Int          @id @default(autoincrement())
  email         String       @unique @db.VarChar(255)
  username      String       @unique @db.VarChar(50)
  password      String       @db.VarChar(255) // bcrypt hash
  avatar        String?      @db.VarChar(500)
  bio           String?      @db.Text
  role          UserRole     @default(USER)
  status        UserStatus   @default(ACTIVE)
  
  // ç»Ÿè®¡å­—æ®µ
  novelsCount   Int          @default(0)
  followersCount Int         @default(0)
  followingCount Int         @default(0)
  
  // æ—¶é—´æˆ³
  createdAt     DateTime     @default(now())
  updatedAt     DateTime     @updatedAt
  lastLoginAt   DateTime?
  
  // å…³è”å…³ç³»
  novels        Novel[]
  comments      Comment[]
  likes         Like[]
  favorites     Favorite[]
  sessions      Session[]
  
  // å…³æ³¨ç³»ç»Ÿ
  following     Follow[]     @relation("UserFollowing")
  followers     Follow[]     @relation("UserFollowers")
  
  @@index([email])
  @@index([username])
  @@index([role, status])
  @@map("users")
}

// ä¼šè¯ç®¡ç†
model Session {
  id            String       @id @default(uuid())
  userId        Int
  token         String       @unique @db.VarChar(500)
  expiresAt     DateTime
  userAgent     String?      @db.VarChar(500)
  ipAddress     String?      @db.VarChar(45)
  
  createdAt     DateTime     @default(now())
  updatedAt     DateTime     @updatedAt
  
  user          User         @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  @@index([userId])
  @@index([token])
  @@index([expiresAt])
  @@map("sessions")
}

// ============= å°è¯´æ¨¡å— =============

enum NovelStatus {
  DRAFT         // è‰ç¨¿
  PUBLISHED     // å·²å‘å¸ƒ
  ARCHIVED      // å·²å½’æ¡£
  DELETED       // å·²åˆ é™¤
}

enum AccessLevel {
  FREE          // å…è´¹
  VIP           // ä¼šå‘˜ä¸“äº«
  PREMIUM       // ä»˜è´¹
}

model Novel {
  id            Int          @id @default(autoincrement())
  title         String       @db.VarChar(200)
  slug          String       @unique @db.VarChar(255) // SEOå‹å¥½URL
  summary       String?      @db.Text
  content       String       @db.LongText // å°è¯´å†…å®¹
  coverUrl      String?      @db.VarChar(500)
  
  // å°è¯´å±æ€§
  status        NovelStatus  @default(DRAFT)
  accessLevel   AccessLevel  @default(FREE)
  wordCount     Int          @default(0)
  chapterCount  Int          @default(1)
  
  // ç»Ÿè®¡æ•°æ®
  views         Int          @default(0)
  likesCount    Int          @default(0)
  favoritesCount Int         @default(0)
  commentsCount Int          @default(0)
  
  // ä½œè€…ä¿¡æ¯
  authorId      Int
  
  // æ—¶é—´æˆ³
  createdAt     DateTime     @default(now())
  updatedAt     DateTime     @updatedAt
  publishedAt   DateTime?
  
  // å…³è”å…³ç³»
  author        User         @relation(fields: [authorId], references: [id], onDelete: Cascade)
  comments      Comment[]
  likes         Like[]
  favorites     Favorite[]
  tags          NovelTag[]
  category      Category?    @relation(fields: [categoryId], references: [id])
  categoryId    Int?
  
  @@index([authorId])
  @@index([status, publishedAt])
  @@index([slug])
  @@index([categoryId])
  @@fulltext([title, summary]) // MySQLå…¨æ–‡ç´¢å¼•
  @@map("novels")
}

// ============= åˆ†ç±»æ ‡ç­¾ =============

model Category {
  id            Int          @id @default(autoincrement())
  name          String       @unique @db.VarChar(50)
  slug          String       @unique @db.VarChar(100)
  description   String?      @db.Text
  icon          String?      @db.VarChar(100)
  sortOrder     Int          @default(0)
  
  createdAt     DateTime     @default(now())
  updatedAt     DateTime     @updatedAt
  
  novels        Novel[]
  
  @@index([slug])
  @@map("categories")
}

model Tag {
  id            Int          @id @default(autoincrement())
  name          String       @unique @db.VarChar(50)
  slug          String       @unique @db.VarChar(100)
  usageCount    Int          @default(0)
  
  createdAt     DateTime     @default(now())
  
  novels        NovelTag[]
  
  @@index([slug])
  @@index([usageCount])
  @@map("tags")
}

model NovelTag {
  novelId       Int
  tagId         Int
  
  novel         Novel        @relation(fields: [novelId], references: [id], onDelete: Cascade)
  tag           Tag          @relation(fields: [tagId], references: [id], onDelete: Cascade)
  
  @@id([novelId, tagId])
  @@index([novelId])
  @@index([tagId])
  @@map("novel_tags")
}

// ============= äº’åŠ¨æ¨¡å— =============

model Comment {
  id            Int          @id @default(autoincrement())
  content       String       @db.Text
  
  // å…³è”
  userId        Int
  novelId       Int
  parentId      Int?         // çˆ¶è¯„è®ºIDï¼ˆæ”¯æŒåµŒå¥—ï¼‰
  
  // çŠ¶æ€
  isDeleted     Boolean      @default(false)
  likesCount    Int          @default(0)
  
  createdAt     DateTime     @default(now())
  updatedAt     DateTime     @updatedAt
  
  user          User         @relation(fields: [userId], references: [id], onDelete: Cascade)
  novel         Novel        @relation(fields: [novelId], references: [id], onDelete: Cascade)
  parent        Comment?     @relation("CommentReplies", fields: [parentId], references: [id], onDelete: Cascade)
  replies       Comment[]    @relation("CommentReplies")
  
  @@index([userId])
  @@index([novelId])
  @@index([parentId])
  @@index([createdAt])
  @@map("comments")
}

model Like {
  id            Int          @id @default(autoincrement())
  userId        Int
  novelId       Int
  
  createdAt     DateTime     @default(now())
  
  user          User         @relation(fields: [userId], references: [id], onDelete: Cascade)
  novel         Novel        @relation(fields: [novelId], references: [id], onDelete: Cascade)
  
  @@unique([userId, novelId]) // é˜²æ­¢é‡å¤ç‚¹èµ
  @@index([userId])
  @@index([novelId])
  @@map("likes")
}

model Favorite {
  id            Int          @id @default(autoincrement())
  userId        Int
  novelId       Int
  
  createdAt     DateTime     @default(now())
  
  user          User         @relation(fields: [userId], references: [id], onDelete: Cascade)
  novel         Novel        @relation(fields: [novelId], references: [id], onDelete: Cascade)
  
  @@unique([userId, novelId]) // é˜²æ­¢é‡å¤æ”¶è—
  @@index([userId])
  @@index([novelId])
  @@map("favorites")
}

model Follow {
  id            Int          @id @default(autoincrement())
  followerId    Int          // å…³æ³¨è€…
  followingId   Int          // è¢«å…³æ³¨è€…
  
  createdAt     DateTime     @default(now())
  
  follower      User         @relation("UserFollowing", fields: [followerId], references: [id], onDelete: Cascade)
  following     User         @relation("UserFollowers", fields: [followingId], references: [id], onDelete: Cascade)
  
  @@unique([followerId, followingId])
  @@index([followerId])
  @@index([followingId])
  @@map("follows")
}

// ============= ç³»ç»Ÿé…ç½® =============

model SystemConfig {
  id            Int          @id @default(autoincrement())
  key           String       @unique @db.VarChar(100)
  value         String       @db.Text
  description   String?      @db.VarChar(500)
  
  createdAt     DateTime     @default(now())
  updatedAt     DateTime     @updatedAt
  
  @@index([key])
  @@map("system_configs")
}
```

### 5.2 æ•°æ®åº“ç´¢å¼•ç­–ç•¥

```sql
-- é«˜é¢‘æŸ¥è¯¢ç´¢å¼•
CREATE INDEX idx_novels_status_published ON novels(status, publishedAt DESC);
CREATE INDEX idx_novels_author_status ON novels(authorId, status);
CREATE INDEX idx_comments_novel_created ON comments(novelId, createdAt DESC);

-- å…¨æ–‡æœç´¢ç´¢å¼•
CREATE FULLTEXT INDEX idx_novels_fulltext ON novels(title, summary);

-- å¤åˆç´¢å¼•
CREATE INDEX idx_users_role_status ON users(role, status);
```

### 5.3 æ•°æ®è¿ç§»è„šæœ¬

```typescript
// scripts/migrate-from-json.ts
import { PrismaClient } from '@prisma/client'
import fs from 'fs'
import path from 'path'
import bcrypt from 'bcryptjs'

const prisma = new PrismaClient()

async function migrateData() {
  console.log('ğŸ“¦ å¼€å§‹æ•°æ®è¿ç§»...')
  
  // 1. è¯»å–æ—§æ•°æ®
  const oldNovels = JSON.parse(
    fs.readFileSync(path.join(__dirname, '../data/novels.json'), 'utf-8')
  )
  const oldUsers = JSON.parse(
    fs.readFileSync(path.join(__dirname, '../data/users.json'), 'utf-8')
  )
  
  // 2. è¿ç§»ç”¨æˆ·
  console.log('ğŸ‘¤ è¿ç§»ç”¨æˆ·æ•°æ®...')
  const userMap = new Map()
  
  for (const oldUser of oldUsers.users) {
    const newUser = await prisma.user.create({
      data: {
        email: oldUser.email,
        username: oldUser.username,
        password: oldUser.password, // å·²åŠ å¯†
        avatar: oldUser.avatar,
        role: oldUser.role === 'admin' ? 'ADMIN' : 'USER',
        createdAt: new Date(oldUser.registerTime),
        lastLoginAt: oldUser.lastLogin ? new Date(oldUser.lastLogin) : null
      }
    })
    userMap.set(oldUser.id, newUser.id)
  }
  
  // 3. è¿ç§»å°è¯´
  console.log('ğŸ“š è¿ç§»å°è¯´æ•°æ®...')
  for (const oldNovel of oldNovels.novels) {
    const slug = generateSlug(oldNovel.title, oldNovel.id)
    
    await prisma.novel.create({
      data: {
        title: oldNovel.title,
        slug,
        summary: oldNovel.summary,
        content: oldNovel.content,
        coverUrl: oldNovel.coverData?.url || null,
        status: oldNovel.status === 'published' ? 'PUBLISHED' : 'DRAFT',
        accessLevel: oldNovel.accessLevel?.toUpperCase() || 'FREE',
        wordCount: oldNovel.content.length,
        views: oldNovel.views || 0,
        likesCount: oldNovel.likes || 0,
        favoritesCount: oldNovel.favorites || 0,
        authorId: 1, // é»˜è®¤ä½œè€…
        createdAt: new Date(oldNovel.publishTime),
        publishedAt: oldNovel.status === 'published' 
          ? new Date(oldNovel.publishTime) 
          : null,
        tags: {
          create: oldNovel.tags?.map(tagName => ({
            tag: {
              connectOrCreate: {
                where: { name: tagName },
                create: {
                  name: tagName,
                  slug: generateSlug(tagName)
                }
              }
            }
          })) || []
        }
      }
    })
  }
  
  console.log('âœ… æ•°æ®è¿ç§»å®Œæˆï¼')
  
  // 4. ç”Ÿæˆç»Ÿè®¡
  const stats = await prisma.$transaction([
    prisma.user.count(),
    prisma.novel.count(),
    prisma.tag.count()
  ])
  
  console.log(`
    ğŸ“Š è¿ç§»ç»Ÿè®¡:
    - ç”¨æˆ·: ${stats[0]}
    - å°è¯´: ${stats[1]}
    - æ ‡ç­¾: ${stats[2]}
  `)
}

function generateSlug(text: string, id?: number): string {
  const slug = text
    .toLowerCase()
    .replace(/[^\w\s-]/g, '')
    .replace(/[\s_-]+/g, '-')
    .replace(/^-+|-+$/g, '')
  
  return id ? `${slug}-${id}` : slug
}

migrateData()
  .catch(console.error)
  .finally(() => prisma.$disconnect())
```

---

## 6. éƒ¨ç½²æ–¹æ¡ˆ

### 6.1 å®å¡”é¢æ¿éƒ¨ç½²æ¶æ„

```
é˜¿é‡Œäº‘ ECS (4æ ¸8G æ¨è)
â”œâ”€â”€ å®å¡”é¢æ¿ 7.x
â”‚   â”œâ”€â”€ Nginx 1.24+
â”‚   â”œâ”€â”€ MySQL 8.0
â”‚   â”œâ”€â”€ PM2 Manager
â”‚   â””â”€â”€ SSL è¯ä¹¦ç®¡ç†
â”‚
â”œâ”€â”€ åº”ç”¨ç›®å½•: /www/wwwroot/novel-platform/
â”‚   â”œâ”€â”€ .next/              # Next.js æ„å»ºäº§ç‰©
â”‚   â”œâ”€â”€ node_modules/
â”‚   â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ prisma/
â”‚   â””â”€â”€ ecosystem.config.js
â”‚
â””â”€â”€ æ•°æ®åº“: novel_platform_db
```

### 6.2 Next.js ç”Ÿäº§æ„å»ºé…ç½®

```javascript
// next.config.js
/** @type {import('next').NextConfig} */
const nextConfig = {
  // âœ… ç‹¬ç«‹æ¨¡å¼ - åŒ…å«æ‰€æœ‰ä¾èµ–
  output: 'standalone',
  
  // å›¾ç‰‡ä¼˜åŒ–é…ç½®
  images: {
    domains: ['your-domain.com', 'cdn.example.com'],
    formats: ['image/avif', 'image/webp'],
    deviceSizes: [640, 750, 828, 1080, 1200, 1920, 2048, 3840],
    imageSizes: [16, 32, 48, 64, 96, 128, 256, 384],
  },
  
  // å‹ç¼©é…ç½®
  compress: true,
  
  // ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–
  productionBrowserSourceMaps: false,
  
  // ç¯å¢ƒå˜é‡
  env: {
    NEXT_PUBLIC_APP_URL: process.env.NEXT_PUBLIC_APP_URL,
  },
  
  // é‡å†™è§„åˆ™ï¼ˆå…¼å®¹å®å¡”ï¼‰
  async rewrites() {
    return [
      {
        source: '/api/:path*',
        destination: '/api/:path*',
      },
    ]
  },
  
  // HTTP å¤´é…ç½®
  async headers() {
    return [
      {
        source: '/:path*',
        headers: [
          {
            key: 'X-DNS-Prefetch-Control',
            value: 'on'
          },
          {
            key: 'X-Frame-Options',
            value: 'SAMEORIGIN'
          },
          {
            key: 'X-Content-Type-Options',
            value: 'nosniff'
          },
        ],
      },
    ]
  },
}

module.exports = nextConfig
```

### 6.3 PM2 é…ç½®

```javascript
// ecosystem.config.js
module.exports = {
  apps: [{
    name: 'novel-platform',
    script: '.next/standalone/server.js',
    cwd: '/www/wwwroot/novel-platform/',
    
    // å®ä¾‹é…ç½®
    instances: 'max', // CPUæ ¸å¿ƒæ•°
    exec_mode: 'cluster',
    
    // ç¯å¢ƒå˜é‡
    env_production: {
      NODE_ENV: 'production',
      PORT: 3000,
      DATABASE_URL: 'mysql://user:pass@localhost:3306/novel_platform_db',
      NEXTAUTH_SECRET: 'your-super-secret-key-change-this',
      NEXTAUTH_URL: 'https://your-domain.com'
    },
    
    // æ—¥å¿—é…ç½®
    log_date_format: 'YYYY-MM-DD HH:mm:ss Z',
    error_file: '/www/wwwlogs/novel-platform-error.log',
    out_file: '/www/wwwlogs/novel-platform-out.log',
    merge_logs: true,
    
    // è¿›ç¨‹ç®¡ç†
    autorestart: true,
    watch: false,
    max_memory_restart: '1G',
    
    // ä¼˜é›…é‡å¯
    kill_timeout: 5000,
    wait_ready: true,
    listen_timeout: 10000,
  }]
}
```

### 6.4 Nginx é…ç½®ï¼ˆå®å¡”é¢æ¿ï¼‰

```nginx
# å®å¡”é¢æ¿ -> ç½‘ç«™ -> é…ç½®æ–‡ä»¶

upstream novel_platform {
    server 127.0.0.1:3000;
    keepalive 64;
}

server {
    listen 80;
    listen 443 ssl http2;
    server_name your-domain.com;
    
    # SSL è¯ä¹¦ï¼ˆå®å¡”è‡ªåŠ¨ç®¡ç†ï¼‰
    ssl_certificate /www/server/panel/vhost/cert/your-domain.com/fullchain.pem;
    ssl_certificate_key /www/server/panel/vhost/cert/your-domain.com/privkey.pem;
    
    # æ ¹ç›®å½•
    root /www/wwwroot/novel-platform/public;
    index index.html;
    
    # Gzip å‹ç¼©
    gzip on;
    gzip_vary on;
    gzip_proxied any;
    gzip_comp_level 6;
    gzip_types text/plain text/css text/xml text/javascript 
               application/json application/javascript application/xml+rss 
               application/rss+xml font/truetype font/opentype 
               application/vnd.ms-fontobject image/svg+xml;
    
    # é™æ€èµ„æºç¼“å­˜
    location /_next/static/ {
        alias /www/wwwroot/novel-platform/.next/static/;
        expires 365d;
        access_log off;
        add_header Cache-Control "public, immutable";
    }
    
    location /images/ {
        alias /www/wwwroot/novel-platform/public/images/;
        expires 30d;
        access_log off;
        add_header Cache-Control "public";
    }
    
    # ä»£ç†åˆ° Next.js
    location / {
        proxy_pass http://novel_platform;
        proxy_http_version 1.1;
        
        # WebSocket æ”¯æŒ
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        
        # æ ‡å‡†ä»£ç†å¤´
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        
        # è¶…æ—¶é…ç½®
        proxy_connect_timeout 60s;
        proxy_send_timeout 60s;
        proxy_read_timeout 60s;
        
        # ç¼“å†²é…ç½®
        proxy_buffering on;
        proxy_buffer_size 4k;
        proxy_buffers 8 4k;
        proxy_busy_buffers_size 8k;
    }
    
    # API é™æµ
    location /api/ {
        limit_req zone=api burst=20 nodelay;
        proxy_pass http://novel_platform;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
    
    # å®‰å…¨å¤´
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-Content-Type-Options "nosniff" always;
    add_header X-XSS-Protection "1; mode=block" always;
    add_header Referrer-Policy "no-referrer-when-downgrade" always;
    
    # ç¦æ­¢è®¿é—®æ•æ„Ÿæ–‡ä»¶
    location ~ /\. {
        deny all;
        access_log off;
        log_not_found off;
    }
    
    # è®¿é—®æ—¥å¿—
    access_log /www/wwwlogs/novel-platform-access.log;
    error_log /www/wwwlogs/novel-platform-error.log;
}

# HTTP è·³è½¬ HTTPS
server {
    listen 80;
    server_name your-domain.com;
    return 301 https://$server_name$request_uri;
}

# é™æµé…ç½®
limit_req_zone $binary_remote_addr zone=api:10m rate=10r/s;
```

### 6.5 éƒ¨ç½²è„šæœ¬

```bash
#!/bin/bash
# deploy.sh - ä¸€é”®éƒ¨ç½²è„šæœ¬

set -e

echo "ğŸš€ å¼€å§‹éƒ¨ç½² Novel Platform..."

# 1. æ‹‰å–æœ€æ–°ä»£ç 
echo "ğŸ“¥ æ‹‰å–ä»£ç ..."
git pull origin main

# 2. å®‰è£…ä¾èµ–
echo "ğŸ“¦ å®‰è£…ä¾èµ–..."
pnpm install --frozen-lockfile

# 3. æ„å»ºåº”ç”¨
echo "ğŸ”¨ æ„å»ºåº”ç”¨..."
pnpm run build

# 4. æ•°æ®åº“è¿ç§»
echo "ğŸ—„ï¸  æ‰§è¡Œæ•°æ®åº“è¿ç§»..."
pnpm prisma migrate deploy
pnpm prisma generate

# 5. é‡å¯ PM2
echo "ğŸ”„ é‡å¯åº”ç”¨..."
pm2 reload ecosystem.config.js --env production

# 6. æ¸…ç†
echo "ğŸ§¹ æ¸…ç†ç¼“å­˜..."
pm2 flush

# 7. å¥åº·æ£€æŸ¥
echo "ğŸ¥ å¥åº·æ£€æŸ¥..."
sleep 5
curl -f http://localhost:3000/api/health || exit 1

echo "âœ… éƒ¨ç½²æˆåŠŸï¼"
echo "ğŸ“Š æŸ¥çœ‹æ—¥å¿—: pm2 logs novel-platform"
```

### 6.6 æ•°æ®åº“å¤‡ä»½ç­–ç•¥

```bash
#!/bin/bash
# backup-db.sh - æ•°æ®åº“å¤‡ä»½è„šæœ¬

DATE=$(date +%Y%m%d_%H%M%S)
BACKUP_DIR="/www/backup/novel-platform"
DB_NAME="novel_platform_db"
DB_USER="root"
DB_PASS="your-password"

# åˆ›å»ºå¤‡ä»½ç›®å½•
mkdir -p $BACKUP_DIR

# å¤‡ä»½æ•°æ®åº“
mysqldump -u$DB_USER -p$DB_PASS $DB_NAME | gzip > $BACKUP_DIR/db_$DATE.sql.gz

# ä¿ç•™æœ€è¿‘30å¤©çš„å¤‡ä»½
find $BACKUP_DIR -name "db_*.sql.gz" -mtime +30 -delete

echo "âœ… æ•°æ®åº“å¤‡ä»½å®Œæˆ: db_$DATE.sql.gz"

# ä¸Šä¼ åˆ°é˜¿é‡Œäº‘OSSï¼ˆå¯é€‰ï¼‰
# ossutil cp $BACKUP_DIR/db_$DATE.sql.gz oss://your-bucket/backups/
```

---

## 7. å¼€å‘è§„èŒƒ

### 7.1 ä»£ç è§„èŒƒ

```typescript
// âœ… è‰¯å¥½ç¤ºä¾‹

// 1. ç±»å‹å®‰å…¨ - ä½¿ç”¨ TypeScript ä¸¥æ ¼æ¨¡å¼
interface NovelCardProps {
  novel: {
    id: number
    title: string
    summary: string | null
    coverUrl: string | null
    author: {
      username: string
      avatar: string | null
    }
    _count: {
      likes: number
      comments: number
    }
  }
  variant?: 'default' | 'compact'
}

export function NovelCard({ novel, variant = 'default' }: NovelCardProps) {
  return (
    <Card className={cn('hover:shadow-lg transition-shadow', {
      'p-4': variant === 'default',
      'p-2': variant === 'compact'
    })}>
      {/* ... */}
    </Card>
  )
}

// 2. Server Component - æ•°æ®è·å–
export default async function NovelsPage({
  searchParams
}: {
  searchParams: { page?: string; tag?: string }
}) {
  const page = Number(searchParams.page) || 1
  const tag = searchParams.tag
  
  const [novels, totalCount] = await Promise.all([
    prisma.novel.findMany({
      where: tag ? {
        status: 'PUBLISHED',
        tags: { some: { tag: { slug: tag } } }
      } : {
        status: 'PUBLISHED'
      },
      skip: (page - 1) * 20,
      take: 20,
      include: {
        author: { select: { username: true, avatar: true } },
        _count: { select: { likes: true, comments: true } }
      },
      orderBy: { publishedAt: 'desc' }
    }),
    prisma.novel.count({
      where: tag ? {
        status: 'PUBLISHED',
        tags: { some: { tag: { slug: tag } } }
      } : {
        status: 'PUBLISHED'
      }
    })
  ])
  
  return (
    <div>
      <NovelGrid novels={novels} />
      <Pagination page={page} totalPages={Math.ceil(totalCount / 20)} />
    </div>
  )
}

// 3. Client Component - äº¤äº’é€»è¾‘
'use client'

import { useState } from 'react'
import { useRouter } from 'next/navigation'

export function LikeButton({ novelId, initialLikes }: {
  novelId: number
  initialLikes: number
}) {
  const [likes, setLikes] = useState(initialLikes)
  const [isLiking, setIsLiking] = useState(false)
  const router = useRouter()
  
  const handleLike = async () => {
    setIsLiking(true)
    
    try {
      const res = await fetch(`/api/novels/${novelId}/like`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' }
      })
      
      if (res.ok) {
        setLikes(prev => prev + 1)
        router.refresh() // åˆ·æ–°æœåŠ¡ç«¯æ•°æ®
      } else if (res.status === 401) {
        router.push('/login')
      }
    } catch (error) {
      console.error('ç‚¹èµå¤±è´¥', error)
    } finally {
      setIsLiking(false)
    }
  }
  
  return (
    <Button
      variant="ghost"
      size="sm"
      onClick={handleLike}
      disabled={isLiking}
    >
      <Heart className={cn('w-4 h-4 mr-1', {
        'fill-red-500 text-red-500': isLiking
      })} />
      {likes}
    </Button>
  )
}
```

### 7.2 Git æäº¤è§„èŒƒ

```bash
# Commit Message æ ¼å¼
<type>(<scope>): <subject>

# type ç±»å‹
feat:     æ–°åŠŸèƒ½
fix:      ä¿®å¤bug
docs:     æ–‡æ¡£æ›´æ–°
style:    ä»£ç æ ¼å¼
refactor: é‡æ„
perf:     æ€§èƒ½ä¼˜åŒ–
test:     æµ‹è¯•
chore:    æ„å»º/å·¥å…·

# ç¤ºä¾‹
feat(novels): æ·»åŠ å°è¯´å…¨æ–‡æœç´¢åŠŸèƒ½
fix(auth): ä¿®å¤ç™»å½•çŠ¶æ€ä¸¢å¤±é—®é¢˜
perf(db): ä¼˜åŒ–å°è¯´åˆ—è¡¨æŸ¥è¯¢æ€§èƒ½
docs(readme): æ›´æ–°éƒ¨ç½²æ–‡æ¡£
```

### 7.3 ç›®å½•å‘½åè§„èŒƒ

```
âœ… æ­£ç¡®:
- components/novels/NovelCard.tsx
- lib/db/novels.ts
- app/admin/novels/page.tsx

âŒ é”™è¯¯:
- components/Novel_Card.tsx
- lib/novelsDB.ts
- app/adminNovels/page.tsx
```

---

## 8. é£é™©è¯„ä¼°

### 8.1 æŠ€æœ¯é£é™©

| é£é™©é¡¹ | ç­‰çº§ | å½±å“ | ç¼“è§£æªæ–½ |
|--------|------|------|----------|
| æ•°æ®è¿ç§»å¤±è´¥ | ğŸ”´ é«˜ | æ•°æ®ä¸¢å¤± | 1. å®Œæ•´å¤‡ä»½<br>2. å¤šæ¬¡æµ‹è¯•<br>3. å›æ»šæ–¹æ¡ˆ |
| æ€§èƒ½ä¸è¾¾æ ‡ | ğŸŸ¡ ä¸­ | ç”¨æˆ·ä½“éªŒå·® | 1. å‹åŠ›æµ‹è¯•<br>2. CDNåŠ é€Ÿ<br>3. æ•°æ®åº“ä¼˜åŒ– |
| å­¦ä¹ æ›²çº¿é™¡å³­ | ğŸŸ¡ ä¸­ | å»¶æœŸ | 1. åŸ¹è®­<br>2. ä»£ç å®¡æŸ¥<br>3. ç»“å¯¹ç¼–ç¨‹ |
| éƒ¨ç½²å¤±è´¥ | ğŸŸ¢ ä½ | æœåŠ¡ä¸­æ–­ | 1. ç°åº¦å‘å¸ƒ<br>2. å¥åº·æ£€æŸ¥<br>3. è‡ªåŠ¨å›æ»š |

### 8.2 ä¸šåŠ¡é£é™©

| é£é™©é¡¹ | æ¦‚ç‡ | å¯¹ç­– |
|--------|------|------|
| ç”¨æˆ·æµå¤± | 20% | ä¿ç•™æ—§ç«™å¤‡ç”¨ï¼Œé€æ­¥è¿ç§» |
| åŠŸèƒ½ç¼ºå¤± | 30% | æ ¸å¿ƒåŠŸèƒ½ä¼˜å…ˆï¼Œå…¶ä»–åˆ†æ‰¹ |
| SEOæ’åä¸‹é™ | 40% | URLé‡å®šå‘ï¼Œsitemapæäº¤ |

---

## 9. é¡¹ç›®æ’æœŸ

### 9.1 æ€»ä½“æ—¶é—´çº¿

```
ç¬¬1-2å‘¨: åŸºç¡€æ¶æ„æ­å»º
â”œâ”€â”€ Week 1
â”‚   â”œâ”€â”€ Day 1-2: é¡¹ç›®åˆå§‹åŒ– + Prismaé…ç½®
â”‚   â”œâ”€â”€ Day 3-4: æ•°æ®åº“æ¨¡å‹è®¾è®¡
â”‚   â””â”€â”€ Day 5: æ•°æ®è¿ç§»è„šæœ¬å¼€å‘
â””â”€â”€ Week 2
    â”œâ”€â”€ Day 1-2: æ ¸å¿ƒç»„ä»¶åº“æ­å»º
    â”œâ”€â”€ Day 3-4: è®¤è¯ç³»ç»Ÿå¼€å‘
    â””â”€â”€ Day 5: é›†æˆæµ‹è¯•

ç¬¬3-4å‘¨: æ ¸å¿ƒåŠŸèƒ½å¼€å‘
â”œâ”€â”€ Week 3
â”‚   â”œâ”€â”€ Day 1-2: å°è¯´å±•ç¤ºæ¨¡å—
â”‚   â”œâ”€â”€ Day 3-4: é˜…è¯»å™¨åŠŸèƒ½
â”‚   â””â”€â”€ Day 5: æœç´¢åŠŸèƒ½
â””â”€â”€ Week 4
    â”œâ”€â”€ Day 1-2: ç®¡ç†åå°åŸºç¡€
    â”œâ”€â”€ Day 3-4: å°è¯´ç¼–è¾‘å™¨
    â””â”€â”€ Day 5: è”è°ƒæµ‹è¯•

ç¬¬5å‘¨: é«˜çº§åŠŸèƒ½
â”œâ”€â”€ Day 1-2: è¯„è®ºç³»ç»Ÿ
â”œâ”€â”€ Day 3: å›¾ç‰‡ä¼˜åŒ–
â””â”€â”€ Day 4-5: æ€§èƒ½ä¼˜åŒ–

ç¬¬6å‘¨: æµ‹è¯•ä¸éƒ¨ç½²
â”œâ”€â”€ Day 1-2: å®Œæ•´æµ‹è¯•
â”œâ”€â”€ Day 3: æ•°æ®è¿ç§»
â”œâ”€â”€ Day 4: ç°åº¦å‘å¸ƒ
â””â”€â”€ Day 5: å…¨é‡ä¸Šçº¿
```

### 9.2 é‡Œç¨‹ç¢‘

| é‡Œç¨‹ç¢‘ | æ—¶é—´ | äº¤ä»˜ç‰© |
|--------|------|--------|
| M1: æ¶æ„æ­å»ºå®Œæˆ | Week 2 | å¯è¿è¡Œçš„ç©ºç™½é¡¹ç›® |
| M2: æ ¸å¿ƒåŠŸèƒ½å®Œæˆ | Week 4 | å°è¯´å±•ç¤º+é˜…è¯» |
| M3: åŠŸèƒ½å®Œå¤‡ | Week 5 | æ‰€æœ‰åŠŸèƒ½å°±ç»ª |
| M4: ä¸Šçº¿éƒ¨ç½² | Week 6 | ç”Ÿäº§ç¯å¢ƒè¿è¡Œ |

---

## 10. é™„å½•

### 10.1 ç¯å¢ƒå˜é‡é…ç½®

```bash
# .env.production

# åº”ç”¨é…ç½®
NODE_ENV=production
NEXT_PUBLIC_APP_URL=https://your-domain.com

# æ•°æ®åº“
DATABASE_URL="mysql://username:password@localhost:3306/novel_platform_db"

# NextAuth
NEXTAUTH_SECRET="your-super-secret-key-min-32-chars"
NEXTAUTH_URL=https://your-domain.com

# æ–‡ä»¶ä¸Šä¼ 
UPLOAD_DIR=/www/wwwroot/novel-platform/public/uploads
MAX_FILE_SIZE=10485760

# é˜¿é‡Œäº‘OSSï¼ˆå¯é€‰ï¼‰
ALIYUN_OSS_REGION=oss-cn-hangzhou
ALIYUN_OSS_BUCKET=your-bucket
ALIYUN_OSS_ACCESS_KEY_ID=your-key
ALIYUN_OSS_ACCESS_KEY_SECRET=your-secret
```

### 10.2 å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥

```bash
# å¼€å‘
pnpm dev              # å¯åŠ¨å¼€å‘æœåŠ¡å™¨
pnpm build            # ç”Ÿäº§æ„å»º
pnpm start            # å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨
pnpm lint             # ä»£ç æ£€æŸ¥

# æ•°æ®åº“
pnpm prisma:generate  # ç”ŸæˆPrisma Client
pnpm prisma:migrate   # æ‰§è¡Œè¿ç§»
pnpm prisma:studio    # æ‰“å¼€æ•°æ®åº“GUI
pnpm prisma:seed      # å¡«å……ç§å­æ•°æ®

# PM2
pm2 start ecosystem.config.js --env production
pm2 reload novel-platform
pm2 logs novel-platform
pm2 monit
```

### 10.3 æ€§èƒ½ä¼˜åŒ–æ£€æŸ¥æ¸…å•

- [ ] å¯ç”¨ Next.js Image ä¼˜åŒ–
- [ ] é…ç½® CDN åŠ é€Ÿ
- [ ] æ•°æ®åº“ç´¢å¼•ä¼˜åŒ–
- [ ] å¯ç”¨ Redis ç¼“å­˜ï¼ˆå¯é€‰ï¼‰
- [ ] å‹ç¼©é™æ€èµ„æº
- [ ] å¯ç”¨ HTTP/2
- [ ] é…ç½®æµè§ˆå™¨ç¼“å­˜
- [ ] æ‡’åŠ è½½å›¾ç‰‡å’Œç»„ä»¶
- [ ] é¢„åŠ è½½å…³é”®èµ„æº
- [ ] ç›‘æ§æ€§èƒ½æŒ‡æ ‡

---

## 11. ç»“è®º

æœ¬é‡æ„æ–¹æ¡ˆé‡‡ç”¨ **Next.js 15 + Prisma + MySQL** æŠ€æœ¯æ ˆï¼Œåœ¨ä¿æŒç°æœ‰åŠŸèƒ½çš„åŸºç¡€ä¸Šï¼Œå°†ç³»ç»Ÿæ¶æ„å‡çº§åˆ°ç°ä»£åŒ–æ ‡å‡†ã€‚é¢„è®¡ï¼š

âœ… **æ€§èƒ½æå‡ 60%+**  
âœ… **å¼€å‘æ•ˆç‡æå‡ 80%+**  
âœ… **ä»£ç å¯ç»´æŠ¤æ€§æå‡ 90%+**  
âœ… **æ”¯æŒ 10ä¸‡+ æ—¥æ´»ç”¨æˆ·**

**æ ¸å¿ƒä¼˜åŠ¿**:
1. ç±»å‹å®‰å…¨ - TypeScript + Prisma æ¶ˆé™¤è¿è¡Œæ—¶é”™è¯¯
2. æ€§èƒ½å“è¶Š - SSR/SSG æ··åˆæ¸²æŸ“ + è‡ªåŠ¨ä¼˜åŒ–
3. æ˜“äºéƒ¨ç½² - å®Œç¾é€‚é…å®å¡”é¢æ¿
4. å¯æ‰©å±•æ€§å¼º - æ¨¡å—åŒ–æ¶æ„æ”¯æŒå¿«é€Ÿè¿­ä»£

**ä¸‹ä¸€æ­¥è¡ŒåŠ¨**:
1. å›¢é˜Ÿè¯„å®¡æœ¬æ–¹æ¡ˆ
2. åˆ†é…ä»»åŠ¡ç»™4ä½å·¥ç¨‹å¸ˆ
3. æ­å»ºå¼€å‘ç¯å¢ƒ
4. å¼€å§‹ç¬¬ä¸€ä¸ªSprint

---

**æ–‡æ¡£ç‰ˆæœ¬**: V1.0  
**æœ€åæ›´æ–°**: 2025-10-26  
**æ–‡æ¡£ä½œè€…**: AI æŠ€æœ¯æ¶æ„å¸ˆ  
**å®¡æ ¸çŠ¶æ€**: âœ… å¾…å›¢é˜Ÿè¯„å®¡

---

> ğŸ’¡ **æç¤º**: æœ¬æ–‡æ¡£æ˜¯æ´»æ–‡æ¡£ï¼Œå°†éšç€é¡¹ç›®æ¨è¿›æŒç»­æ›´æ–°ã€‚ä»»ä½•æŠ€æœ¯å†³ç­–å˜æ›´è¯·åŠæ—¶åŒæ­¥åˆ°æ­¤æ–‡æ¡£ã€‚

