# 🚨 项目风险管理和应急预案

> **风险管理负责人**: 项目经理 + 工程师D  
> **更新频率**: 每周  
> **应急联系人**: [待填写]

---

## 1. 风险识别矩阵

### 风险等级定义

```
严重程度 × 发生概率 = 风险等级

严重程度：
5 - 致命    项目失败
4 - 严重    核心功能受影响
3 - 一般    部分功能受影响
2 - 较小    体验下降
1 - 轻微    可忽略

发生概率：
A - 很高 (>60%)
B - 高 (40-60%)
C - 中 (20-40%)
D - 低 (<20%)

风险等级 = 严重程度 × 概率字母
红色：5A, 5B, 4A (高危)
黄色：5C, 4B, 3A (中危)
绿色：其他 (低危)
```

---

## 2. 风险清单

### 🔴 高危风险（必须立即应对）

#### 风险1：数据迁移失败/数据丢失

**风险等级**: 🔴 5A (致命 × 很高)

**影响**:
- 用户数据永久丢失
- 项目无法继续
- 品牌信誉严重受损

**概率**: 60% (如果没有详细的迁移方案)

**缓解措施**:
```
预防：
[ ] 制定详细的数据迁移方案（已完成）
[ ] 测试环境完整测试3次
[ ] 多重备份（本地+云端）
[ ] 制定回滚方案
[ ] 数据迁移Checklist打印并执行

检测：
[ ] 迁移后立即执行数据完整性验证脚本
[ ] 抽样检查10%数据内容
[ ] 对比新旧系统数据总量

应对：
[ ] 如发现数据丢失，立即停止迁移
[ ] 执行回滚脚本恢复旧数据
[ ] 分析原因，修复后重新执行
```

**责任人**: 工程师A + 工程师D

**应急联系**: 
- 工程师A: [手机号]
- 数据库专家(外部顾问): [手机号]

---

#### 风险2：没有专职测试人员导致质量问题

**风险等级**: 🔴 4A (严重 × 很高)

**影响**:
- 生产环境出现严重Bug
- 用户体验极差
- 上线后需紧急修复（成本高10倍）

**概率**: 80% (当前配置下)

**缓解措施**:
```
预防：
[ ] 立即招聘工程师E（QA测试工程师）⭐⭐⭐⭐⭐
[ ] 编写测试计划和测试用例（已完成）
[ ] 搭建自动化测试框架

如果无法招到QA，备选方案：
[ ] 工程师D承担50%测试工作
[ ] 工程师B/C各承担25%测试工作
[ ] 外包部分测试工作（E2E测试）
[ ] 延长测试周期1周
```

**责任人**: 项目经理

**决策deadline**: Week 3 Day 1（必须决定）

---

#### 风险3：关键工程师离职或生病

**风险等级**: 🔴 5C (致命 × 中)

**影响**:
- 某些模块无人接手
- 项目严重延期

**概率**: 20%

**缓解措施**:
```
预防：
[ ] 关键代码必须有注释
[ ] 每周代码Review，至少2人了解每个模块
[ ] 重要技术决策文档化
[ ] 工程师D作为backup（全栈）

应对：
[ ] 如工程师A离职 → 工程师D接手数据库
[ ] 如工程师B离职 → 外包前端开发
[ ] 如工程师C离职 → 工程师D接手后端
[ ] 如工程师D离职 → 考虑项目延期

紧急招聘渠道准备：
- Boss直聘VIP账号
- 猎头公司联系方式
- 内部推荐激励政策
```

**责任人**: 项目经理 + HR

---

### 🟡 中危风险（需要密切关注）

#### 风险4：第三方服务不可用

**风险等级**: 🟡 4B (严重 × 高)

**影响范围**:
- 阿里云OSS故障 → 图片无法上传
- 数据库服务宕机 → 系统完全不可用
- CDN故障 → 静态资源加载缓慢

**缓解措施**:
```
预防：
[ ] 图片上传支持本地存储（降级方案）
[ ] 数据库主从备份
[ ] CDN多供应商备份（可选）

应对：
[ ] OSS故障 → 切换到本地存储
[ ] 数据库故障 → 切换到备库
[ ] CDN故障 → 直接从源站加载
```

**监控**:
```bash
# 每5分钟检查服务可用性
*/5 * * * * curl -f https://your-domain.com/api/health || notify-admin
```

---

#### 风险5：性能不达标

**风险等级**: 🟡 3A (一般 × 很高)

**影响**:
- 用户体验差
- SEO排名下降
- 服务器成本增加

**性能目标**:
```
目标                 当前      风险
--------------------------------
Lighthouse Score    95+        90-94
API响应时间         <100ms     100-200ms
首屏加载           <1.5s      1.5-3s
并发用户           1000+      500-1000
```

**缓解措施**:
```
Week 5 Day 3: 性能测试
├── 如果不达标
│   ├── Day 4-5: 紧急优化
│   ├── 数据库查询优化
│   ├── 添加Redis缓存
│   └── CDN加速
│   
└── 如果仍不达标
    ├── 申请延期1周
    ├── 或降低性能目标
    └── 分阶段优化
```

---

#### 风险6：时间不足导致功能削减

**风险等级**: 🟡 3A (一般 × 很高)

**概率**: 50%

**可能被削减的功能**（优先级排序）:
```
P0 - 核心功能（不能删）
├── 用户认证
├── 小说展示
├── 小说阅读
└── 管理后台基础

P1 - 重要功能（可延后）
├── 评论系统  ← 可以V2
├── 关注系统  ← 可以V2
├── 全文搜索  ← 可以先做简单搜索
└── 高级编辑器 ← 可以先用简单编辑器

P2 - 次要功能（可砍）
├── 社交分享
├── 阅读统计图表
├── 推荐算法
└── 多主题切换
```

**决策流程**:
```
Week 4 Day 5: 进度评估
├── 如果落后2天以上
│   └── 砍掉1-2个P2功能
│   
├── 如果落后4天以上
│   └── 砍掉P2全部 + 1个P1功能
│   
└── 如果落后6天以上
    └── 申请延期1周 or 大幅削减功能
```

**责任人**: 项目经理 + 技术负责人(工程师A)

---

#### 风险7：前后端联调问题

**风险等级**: 🟡 3A (一般 × 很高)

**常见问题**:
- API接口定义不一致
- 数据格式不匹配
- 权限验证失败
- CORS跨域问题

**缓解措施**:
```
预防：
[ ] Week 2: API接口文档定义（Swagger）
[ ] 前后端共同评审接口文档
[ ] Mock数据生成，前端先开发
[ ] 使用TypeScript共享类型定义

联调计划：
Week 4 Day 1-2: 前后端联调周
├── 09:00-12:00: 集中联调
├── 13:00-18:00: 问题修复
└── 每天站会同步问题

工具支持：
[ ] Postman共享API collection
[ ] 使用 tRPC 或 GraphQL（类型安全）
[ ] 日志详细记录请求参数
```

---

### 🟢 低危风险（了解即可）

#### 风险8：浏览器兼容性问题

**风险等级**: 🟢 2C (较小 × 中)

**应对**: Week 5兼容性测试，发现问题再fix

#### 风险9：UI设计延期

**风险等级**: 🟢 2B (较小 × 高)

**应对**: 使用shadcn/ui默认样式先开发，后续替换

#### 风险10：第三方库Bug

**风险等级**: 🟢 2D (较小 × 低)

**应对**: 选择成熟稳定的库，避免使用新版本

---

## 3. 风险监控

### 每日监控清单

```
每天17:00: 风险检查
[ ] 进度是否落后？落后多少天？
[ ] 是否有人遇到阻塞？
[ ] 是否有新的风险出现？
[ ] 测试覆盖率是否达标？
[ ] 代码质量是否下降？
```

### 每周风险报告

```markdown
# 风险周报 - Week X

## 新增风险
- [风险描述] - 风险等级 - 应对措施

## 风险变化
- [风险X] 从 🟡 升级到 🔴
- [风险Y] 从 🟡 降低到 🟢

## 已解决风险
- [风险Z] 已完全解决

## 重点关注
本周需重点关注 [风险A] 和 [风险B]
```

---

## 4. 应急预案

### 应急预案1：数据迁移失败

**触发条件**:
- 数据丢失 > 5%
- 数据验证失败
- 迁移脚本报错

**应急步骤**:
```
第1步（立即）: 停止所有写入操作
├── pm2 stop novel-platform
└── 将网站设为维护模式

第2步（5分钟内）: 评估损失
├── 运行数据验证脚本
├── 统计丢失数据量
└── 判断是否可修复

第3步（决策）:
├── 如可修复（丢失<1%）
│   └── 执行增量数据恢复
│   
└── 如不可修复
    ├── 执行完整回滚
    ├── 从备份恢复
    └── 分析原因，修复后重新迁移

第4步（完成后）: 
├── 再次验证数据完整性
├── 用户公告
└── 系统恢复正常
```

**责任人**: 工程师A

**应急联系人**:
- 项目经理: [手机]
- CTO/技术负责人: [手机]

**回滚脚本位置**: `scripts/rollback-migration.js`

---

### 应急预案2：生产环境严重Bug

**触发条件**:
- P0级bug（系统崩溃、数据损坏）
- P1级bug影响核心功能

**应急步骤**:
```
第1步（立即）: 评估影响
├── Bug影响多少用户？
├── 是否需要立即下线？
└── 能否快速修复？

第2步（决策）:
├── 如影响>50%用户
│   └── 立即回滚到旧版本
│   
└── 如影响<50%用户
    └── 紧急修复并部署

第3步（修复）:
├── 拉取main分支
├── 创建hotfix分支
├── 快速修复（<2小时）
├── 测试验证
└── 部署上线

第4步（复盘）:
├── 分析根本原因
├── 补充测试用例
└── 更新应急预案
```

**响应时间要求**:
- P0 Bug: 30分钟内响应
- P1 Bug: 2小时内响应
- P2 Bug: 1天内响应

---

### 应急预案3：服务器宕机

**触发条件**:
- 网站无法访问
- 数据库连接失败
- 服务器CPU/内存100%

**应急步骤**:
```
第1步（立即）: 检查服务状态
├── pm2 status
├── systemctl status nginx
├── systemctl status mysql
└── 查看服务器资源使用率

第2步（定位问题）:
├── 查看错误日志
│   ├── tail -n 100 /www/wwwlogs/novel-platform-error.log
│   ├── tail -n 100 /var/log/mysql/error.log
│   └── tail -n 100 /var/log/nginx/error.log
│   
└── 确定问题根源
    ├── 应用bug导致崩溃
    ├── 数据库锁表
    ├── 磁盘空间满
    └── DDoS攻击

第3步（应对）:
├── 如应用崩溃 → pm2 restart novel-platform
├── 如数据库问题 → 重启MySQL or 优化查询
├── 如磁盘满 → 清理日志文件
└── 如遭受攻击 → 启用WAF or 限流

第4步（恢复后）:
├── 验证所有功能正常
├── 监控资源使用率
└── 通知用户（如停机>5分钟）
```

---

### 应急预案4：关键工程师突然离职

**触发条件**:
- 工程师A/B/C突然提出离职（<2周notice）

**应急步骤**:
```
第1步（当天）: 知识交接
├── 要求离职员工整理文档
├── 代码注释补充
├── 录制操作视频
└── 交接核心账号密码

第2步（1周内）: 找人接手
├── 工程师D临时顶上
├── 启动紧急招聘
├── 或外包接手部分工作
└── 评估项目延期

第3步（2周内）: 新人到位
├── 快速熟悉项目
├── 与离职员工交接
└── 继续推进项目
```

**降低风险措施**:
- 提前识别离职倾向（沟通减少、消极怠工）
- 核心代码必须有备份人
- 重要决策必须文档化
- 定期Team Building增强团队凝聚力

---

## 5. 决策树

### 进度落后决策树

```
进度是否落后？
│
├─ 否 → 继续按计划执行
│
└─ 是 → 落后多少天？
    │
    ├─ 1-2天
    │  └─ 团队加班追赶
    │
    ├─ 3-4天
    │  ├─ 削减P2功能
    │  └─ 团队加班
    │
    ├─ 5-7天
    │  ├─ 削减P2全部
    │  ├─ 削减1-2个P1功能
    │  └─ 考虑延期1周
    │
    └─ >7天
       ├─ 申请延期2周
       └─ 大幅削减功能
           或考虑重新评估项目
```

### Bug修复决策树

```
发现Bug
│
├─ Bug级别判断
│  │
│  ├─ P0 (致命) → 立即修复
│  │   └─ 30分钟内响应，2小时内修复
│  │
│  ├─ P1 (严重) → 优先修复
│  │   └─ 2小时内响应，当天修复
│  │
│  ├─ P2 (一般) → 排期修复
│  │   └─ 1天内响应，3天内修复
│  │
│  └─ P3 (轻微) → 可延后
│      └─ 记录到backlog，后续版本修复
```

---

## 6. 应急联系方式

### 团队联系表

```
角色            姓名    手机          微信        备注
------------------------------------------------------------
项目经理        [待填]  138****1234   xxxxx      24小时on-call
工程师A         [待填]  139****5678   xxxxx      数据库专家
工程师B         [待填]  137****9012   xxxxx      前端负责人
工程师C         [待填]  136****3456   xxxxx      后端+运维
工程师D         [待填]  135****7890   xxxxx      全栈+救火
工程师E         [待填]  134****1234   xxxxx      测试负责人
```

### 外部联系

```
服务商          联系方式                  说明
------------------------------------------------------------
阿里云          95187                    服务器/数据库
宝塔面板        400-****-****             技术支持
域名注册商      [客服电话]               域名相关
```

### 升级机制

```
级别1 (工程师自行解决)
└─ 无法解决 →

级别2 (工程师D协助)
└─ 无法解决 →

级别3 (项目经理协调)
└─ 无法解决 →

级别4 (技术负责人/CTO)
```

---

## 7. 风险复盘

### 复盘时机

- 每周五下午
- 重大风险发生后
- 项目结束时

### 复盘模板

```markdown
# 风险复盘 - [事件名称]

## 事件概述
- 时间：
- 影响：
- 持续时间：

## 根本原因
1. 技术原因
2. 管理原因
3. 流程原因

## 应对措施
- 做对了什么？
- 做错了什么？
- 下次如何改进？

## 行动计划
- [ ] 改进措施1
- [ ] 改进措施2
- [ ] 更新应急预案
```

---

## 8. 风险管理工具

### 推荐工具

```
风险追踪: Jira Risk Register / Excel
沟通工具: 飞书 / 钉钉 / Slack
监控工具: 宝塔面板 + 自定义脚本
文档管理: 腾讯文档 / Notion
```

### 风险看板（Jira）

```
待识别 | 评估中 | 正在缓解 | 已解决
---------------------------------------
风险X   风险Y    风险Z      风险W
       风险A    风险B      风险C
```

---

**最后更新**: 2025-10-26  
**下次更新**: 每周五  
**文档状态**: ✅ 活文档（持续更新）  
**负责人**: 项目经理

