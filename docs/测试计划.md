# ğŸ§ª æµ‹è¯•è®¡åˆ’æ–‡æ¡£

> **è´Ÿè´£äºº**: å·¥ç¨‹å¸ˆE (QAæµ‹è¯•å·¥ç¨‹å¸ˆ) - **éœ€è¦æ–°å¢è¿™ä¸ªè§’è‰²ï¼**  
> **ååŠ©**: å·¥ç¨‹å¸ˆD (æ€§èƒ½æµ‹è¯•)  
> **æµ‹è¯•å‘¨æœŸ**: Week 4-6  
> **æµ‹è¯•è¦†ç›–ç‡ç›®æ ‡**: 80%+

---

## 1. æµ‹è¯•è§’è‰²å’ŒèŒè´£

### âš ï¸ å½“å‰å›¢é˜Ÿé…ç½®é—®é¢˜

**é—®é¢˜**: æ²¡æœ‰ä¸“èŒQAæµ‹è¯•å·¥ç¨‹å¸ˆï¼

**å»ºè®®**: å¿…é¡»æ–°å¢å·¥ç¨‹å¸ˆE - QAæµ‹è¯•å·¥ç¨‹å¸ˆ

```
å·¥ç¨‹å¸ˆE - QAæµ‹è¯•å·¥ç¨‹å¸ˆ
â”œâ”€â”€ æŠ€èƒ½è¦æ±‚
â”‚   â”œâ”€â”€ ç†Ÿæ‚‰Jest/Vitestå•å…ƒæµ‹è¯•
â”‚   â”œâ”€â”€ ç†Ÿæ‚‰Cypress/Playwright E2Eæµ‹è¯•
â”‚   â”œâ”€â”€ æŒæ¡æ€§èƒ½æµ‹è¯•å·¥å…·(K6, Lighthouse)
â”‚   â”œâ”€â”€ äº†è§£MySQLæ•°æ®åº“
â”‚   â””â”€â”€ æœ‰æµ‹è¯•ç”¨ä¾‹ç¼–å†™ç»éªŒ
â”‚
â”œâ”€â”€ æ ¸å¿ƒèŒè´£
â”‚   â”œâ”€â”€ ç¼–å†™æµ‹è¯•ç”¨ä¾‹(500+)
â”‚   â”œâ”€â”€ æ‰§è¡Œæ‰‹åŠ¨æµ‹è¯•
â”‚   â”œâ”€â”€ è‡ªåŠ¨åŒ–æµ‹è¯•æ¡†æ¶æ­å»º
â”‚   â”œâ”€â”€ Bugè·Ÿè¸ªå’Œç®¡ç†
â”‚   â””â”€â”€ å›å½’æµ‹è¯•
â”‚
â””â”€â”€ å·¥ä½œæ—¶é—´
    â”œâ”€â”€ Week 3: æµ‹è¯•è®¡åˆ’åˆ¶å®š
    â”œâ”€â”€ Week 4-5: æµ‹è¯•æ‰§è¡Œ
    â””â”€â”€ Week 6: å›å½’æµ‹è¯•
```

---

## 2. æµ‹è¯•åˆ†å±‚ç­–ç•¥

```
é‡‘å­—å¡”æµ‹è¯•æ¨¡å‹
         â•±â•²
        â•±E2Eâ•²           5%  - ç«¯åˆ°ç«¯æµ‹è¯•(å…³é”®æµç¨‹)
       â•±â”€â”€â”€â”€â•²
      â•± é›†æˆ  â•²         15% - é›†æˆæµ‹è¯•(APIæµ‹è¯•)
     â•±â”€â”€â”€â”€â”€â”€â”€â”€â•²
    â•± å•å…ƒæµ‹è¯•  â•²       80% - å•å…ƒæµ‹è¯•(å‡½æ•°/ç»„ä»¶)
   â•±â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•²
```

---

## 3. å•å…ƒæµ‹è¯•è®¡åˆ’ï¼ˆ80%ï¼‰

### 3.1 åç«¯å•å…ƒæµ‹è¯•

**ç›®æ ‡**: å…³é”®ä¸šåŠ¡é€»è¾‘è¦†ç›–ç‡ 90%+

```typescript
// tests/lib/db/novels.test.ts
import { describe, it, expect, beforeEach, afterEach } from 'vitest'
import { PrismaClient } from '@prisma/client'
import { 
  getPublishedNovels, 
  getNovelBySlug,
  createNovel,
  deleteNovel 
} from '@/lib/db/novels'

const prisma = new PrismaClient()

describe('Novels Database Operations', () => {
  beforeEach(async () => {
    // æ¸…ç©ºæµ‹è¯•æ•°æ®
    await prisma.novel.deleteMany()
    await prisma.user.deleteMany()
    
    // åˆ›å»ºæµ‹è¯•ç”¨æˆ·
    await prisma.user.create({
      data: {
        email: 'test@test.com',
        username: 'testuser',
        password: 'hashedpassword'
      }
    })
  })
  
  afterEach(async () => {
    await prisma.$disconnect()
  })
  
  describe('getPublishedNovels', () => {
    it('åº”è¯¥è¿”å›å·²å‘å¸ƒçš„å°è¯´', async () => {
      // åˆ›å»ºæµ‹è¯•æ•°æ®
      await prisma.novel.create({
        data: {
          title: 'æµ‹è¯•å°è¯´',
          slug: 'test-novel',
          content: 'æµ‹è¯•å†…å®¹',
          status: 'PUBLISHED',
          authorId: 1
        }
      })
      
      const result = await getPublishedNovels({ page: 1, pageSize: 20 })
      
      expect(result.novels).toHaveLength(1)
      expect(result.novels[0].title).toBe('æµ‹è¯•å°è¯´')
      expect(result.pagination.totalCount).toBe(1)
    })
    
    it('ä¸åº”è¯¥è¿”å›è‰ç¨¿çŠ¶æ€çš„å°è¯´', async () => {
      await prisma.novel.create({
        data: {
          title: 'è‰ç¨¿å°è¯´',
          slug: 'draft-novel',
          content: 'è‰ç¨¿å†…å®¹',
          status: 'DRAFT',
          authorId: 1
        }
      })
      
      const result = await getPublishedNovels({ page: 1, pageSize: 20 })
      
      expect(result.novels).toHaveLength(0)
    })
    
    it('åº”è¯¥æ­£ç¡®å¤„ç†åˆ†é¡µ', async () => {
      // åˆ›å»º25éƒ¨å°è¯´
      for (let i = 0; i < 25; i++) {
        await prisma.novel.create({
          data: {
            title: `å°è¯´${i}`,
            slug: `novel-${i}`,
            content: 'å†…å®¹',
            status: 'PUBLISHED',
            authorId: 1
          }
        })
      }
      
      const page1 = await getPublishedNovels({ page: 1, pageSize: 20 })
      expect(page1.novels).toHaveLength(20)
      expect(page1.pagination.hasNext).toBe(true)
      
      const page2 = await getPublishedNovels({ page: 2, pageSize: 20 })
      expect(page2.novels).toHaveLength(5)
      expect(page2.pagination.hasNext).toBe(false)
    })
  })
  
  describe('getNovelBySlug', () => {
    it('åº”è¯¥æ ¹æ®slugè¿”å›å°è¯´', async () => {
      await prisma.novel.create({
        data: {
          title: 'æµ‹è¯•å°è¯´',
          slug: 'test-novel',
          content: 'æµ‹è¯•å†…å®¹',
          status: 'PUBLISHED',
          authorId: 1
        }
      })
      
      const novel = await getNovelBySlug('test-novel')
      
      expect(novel).not.toBeNull()
      expect(novel?.title).toBe('æµ‹è¯•å°è¯´')
    })
    
    it('æ‰¾ä¸åˆ°å°è¯´æ—¶åº”è¿”å›null', async () => {
      const novel = await getNovelBySlug('non-existent')
      expect(novel).toBeNull()
    })
  })
  
  describe('createNovel', () => {
    it('åº”è¯¥æˆåŠŸåˆ›å»ºå°è¯´', async () => {
      const novelData = {
        title: 'æ–°å°è¯´',
        slug: 'new-novel',
        content: 'è¿™æ˜¯å†…å®¹',
        authorId: 1,
        status: 'PUBLISHED' as const
      }
      
      const novel = await createNovel(novelData)
      
      expect(novel.id).toBeDefined()
      expect(novel.title).toBe('æ–°å°è¯´')
      expect(novel.wordCount).toBe(novelData.content.length)
    })
    
    it('åˆ›å»ºå·²å‘å¸ƒå°è¯´æ—¶åº”è®¾ç½®publishedAt', async () => {
      const novel = await createNovel({
        title: 'å‘å¸ƒå°è¯´',
        slug: 'published-novel',
        content: 'å†…å®¹',
        authorId: 1,
        status: 'PUBLISHED'
      })
      
      expect(novel.publishedAt).not.toBeNull()
    })
    
    it('åˆ›å»ºè‰ç¨¿æ—¶ä¸åº”è®¾ç½®publishedAt', async () => {
      const novel = await createNovel({
        title: 'è‰ç¨¿',
        slug: 'draft',
        content: 'å†…å®¹',
        authorId: 1,
        status: 'DRAFT'
      })
      
      expect(novel.publishedAt).toBeNull()
    })
  })
  
  describe('deleteNovel', () => {
    it('è½¯åˆ é™¤åº”è¯¥å°†çŠ¶æ€æ”¹ä¸ºDELETED', async () => {
      const novel = await prisma.novel.create({
        data: {
          title: 'è¦åˆ é™¤çš„å°è¯´',
          slug: 'to-delete',
          content: 'å†…å®¹',
          status: 'PUBLISHED',
          authorId: 1
        }
      })
      
      await deleteNovel(novel.id, true)
      
      const deleted = await prisma.novel.findUnique({
        where: { id: novel.id }
      })
      
      expect(deleted?.status).toBe('DELETED')
    })
    
    it('ç¡¬åˆ é™¤åº”è¯¥ä»æ•°æ®åº“ç§»é™¤è®°å½•', async () => {
      const novel = await prisma.novel.create({
        data: {
          title: 'è¦åˆ é™¤çš„å°è¯´',
          slug: 'to-delete',
          content: 'å†…å®¹',
          status: 'PUBLISHED',
          authorId: 1
        }
      })
      
      await deleteNovel(novel.id, false)
      
      const deleted = await prisma.novel.findUnique({
        where: { id: novel.id }
      })
      
      expect(deleted).toBeNull()
    })
  })
})
```

**éœ€è¦æµ‹è¯•çš„æ¨¡å—**:
```bash
[ ] lib/db/novels.ts       - 10ä¸ªå‡½æ•°, 50+æµ‹è¯•ç”¨ä¾‹
[ ] lib/db/users.ts        - 10ä¸ªå‡½æ•°, 40+æµ‹è¯•ç”¨ä¾‹  
[ ] lib/db/comments.ts     - 6ä¸ªå‡½æ•°, 30+æµ‹è¯•ç”¨ä¾‹
[ ] lib/utils/validation.ts- éªŒè¯å‡½æ•°, 20+æµ‹è¯•ç”¨ä¾‹
[ ] lib/utils/format.ts    - æ ¼å¼åŒ–å‡½æ•°, 15+æµ‹è¯•ç”¨ä¾‹
```

### 3.2 å‰ç«¯ç»„ä»¶æµ‹è¯•

```typescript
// tests/components/NovelCard.test.tsx
import { render, screen, fireEvent } from '@testing-library/react'
import { describe, it, expect, vi } from 'vitest'
import { NovelCard } from '@/components/novels/NovelCard'

describe('NovelCard Component', () => {
  const mockNovel = {
    id: 1,
    title: 'æµ‹è¯•å°è¯´',
    summary: 'è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•å°è¯´',
    coverUrl: '/test-cover.jpg',
    author: {
      username: 'testuser',
      avatar: '/avatar.jpg'
    },
    _count: {
      likes: 10,
      comments: 5
    }
  }
  
  it('åº”è¯¥æ¸²æŸ“å°è¯´æ ‡é¢˜', () => {
    render(<NovelCard novel={mockNovel} />)
    expect(screen.getByText('æµ‹è¯•å°è¯´')).toBeInTheDocument()
  })
  
  it('åº”è¯¥æ¸²æŸ“å°è¯´æ‘˜è¦', () => {
    render(<NovelCard novel={mockNovel} />)
    expect(screen.getByText('è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•å°è¯´')).toBeInTheDocument()
  })
  
  it('åº”è¯¥æ˜¾ç¤ºä½œè€…åç§°', () => {
    render(<NovelCard novel={mockNovel} />)
    expect(screen.getByText('testuser')).toBeInTheDocument()
  })
  
  it('åº”è¯¥æ˜¾ç¤ºç‚¹èµæ•°å’Œè¯„è®ºæ•°', () => {
    render(<NovelCard novel={mockNovel} />)
    expect(screen.getByText('10')).toBeInTheDocument()
    expect(screen.getByText('5')).toBeInTheDocument()
  })
  
  it('ç‚¹å‡»å¡ç‰‡åº”è¯¥å¯¼èˆªåˆ°è¯¦æƒ…é¡µ', () => {
    const mockRouter = vi.fn()
    render(<NovelCard novel={mockNovel} />)
    
    const card = screen.getByRole('article')
    fireEvent.click(card)
    
    // éªŒè¯å¯¼èˆªé€»è¾‘
  })
  
  it('hoveræ—¶åº”è¯¥æ˜¾ç¤ºé˜´å½±æ•ˆæœ', () => {
    const { container } = render(<NovelCard novel={mockNovel} />)
    const card = container.firstChild as HTMLElement
    
    expect(card.className).toContain('hover:shadow-lg')
  })
})
```

**éœ€è¦æµ‹è¯•çš„ç»„ä»¶**:
```bash
[ ] components/novels/NovelCard.tsx
[ ] components/novels/NovelGrid.tsx
[ ] components/novels/NovelReader.tsx
[ ] components/layout/Header.tsx
[ ] components/ui/* (shadcnç»„ä»¶)
```

---

## 4. é›†æˆæµ‹è¯•è®¡åˆ’ï¼ˆ15%ï¼‰

### 4.1 APIé›†æˆæµ‹è¯•

```typescript
// tests/api/novels.test.ts
import { describe, it, expect, beforeEach } from 'vitest'
import { createMocks } from 'node-mocks-http'
import { GET, POST } from '@/app/api/novels/route'

describe('API: /api/novels', () => {
  beforeEach(async () => {
    // é‡ç½®æ•°æ®åº“
  })
  
  describe('GET /api/novels', () => {
    it('åº”è¯¥è¿”å›å°è¯´åˆ—è¡¨', async () => {
      const { req } = createMocks({
        method: 'GET',
        url: '/api/novels?page=1&pageSize=20'
      })
      
      const response = await GET(req as any)
      const data = await response.json()
      
      expect(response.status).toBe(200)
      expect(data.success).toBe(true)
      expect(Array.isArray(data.data)).toBe(true)
      expect(data.pagination).toBeDefined()
    })
    
    it('åº”è¯¥æ”¯æŒåˆ†é¡µå‚æ•°', async () => {
      const { req } = createMocks({
        method: 'GET',
        url: '/api/novels?page=2&pageSize=10'
      })
      
      const response = await GET(req as any)
      const data = await response.json()
      
      expect(data.pagination.page).toBe(2)
      expect(data.pagination.pageSize).toBe(10)
    })
  })
  
  describe('POST /api/novels', () => {
    it('æœªç™»å½•ç”¨æˆ·åº”è¿”å›401', async () => {
      const { req } = createMocks({
        method: 'POST',
        body: {
          title: 'æ–°å°è¯´',
          content: 'å†…å®¹'
        }
      })
      
      const response = await POST(req as any)
      
      expect(response.status).toBe(401)
    })
    
    it('å·²ç™»å½•ç”¨æˆ·åº”è¯¥èƒ½åˆ›å»ºå°è¯´', async () => {
      // æ¨¡æ‹Ÿç™»å½•session
      const { req } = createMocks({
        method: 'POST',
        body: {
          title: 'æ–°å°è¯´',
          content: 'è¿™æ˜¯å†…å®¹'
        },
        headers: {
          cookie: 'session=valid-session-token'
        }
      })
      
      const response = await POST(req as any)
      const data = await response.json()
      
      expect(response.status).toBe(200)
      expect(data.success).toBe(true)
      expect(data.data.title).toBe('æ–°å°è¯´')
    })
    
    it('ç¼ºå°‘å¿…å¡«å­—æ®µåº”è¿”å›400', async () => {
      const { req } = createMocks({
        method: 'POST',
        body: {
          // ç¼ºå°‘ title
          content: 'å†…å®¹'
        },
        headers: {
          cookie: 'session=valid-session-token'
        }
      })
      
      const response = await POST(req as any)
      
      expect(response.status).toBe(400)
    })
  })
})
```

**éœ€è¦æµ‹è¯•çš„APIç«¯ç‚¹**:
```bash
[ ] GET /api/novels          - åˆ—è¡¨æŸ¥è¯¢
[ ] POST /api/novels         - åˆ›å»ºå°è¯´
[ ] GET /api/novels/[id]     - è¯¦æƒ…æŸ¥è¯¢
[ ] PUT /api/novels/[id]     - æ›´æ–°å°è¯´
[ ] DELETE /api/novels/[id]  - åˆ é™¤å°è¯´
[ ] POST /api/novels/[id]/like      - ç‚¹èµ
[ ] POST /api/novels/[id]/favorite  - æ”¶è—
[ ] GET /api/users           - ç”¨æˆ·åˆ—è¡¨
[ ] POST /api/auth/login     - ç™»å½•
[ ] POST /api/upload/image   - å›¾ç‰‡ä¸Šä¼ 
```

---

## 5. E2Eæµ‹è¯•è®¡åˆ’ï¼ˆ5%ï¼‰

### 5.1 å…³é”®ç”¨æˆ·æµç¨‹æµ‹è¯•

ä½¿ç”¨ **Playwright** è¿›è¡ŒE2Eæµ‹è¯•

```typescript
// tests/e2e/user-journey.spec.ts
import { test, expect } from '@playwright/test'

test.describe('ç”¨æˆ·å®Œæ•´æµç¨‹', () => {
  test('è®¿å®¢æµè§ˆå°è¯´å¹¶æ³¨å†Œç™»å½•', async ({ page }) => {
    // 1. è®¿é—®é¦–é¡µ
    await page.goto('/')
    await expect(page).toHaveTitle(/MOMOç‚’é¥­åº—/)
    
    // 2. æµè§ˆå°è¯´åˆ—è¡¨
    await page.click('text=å°è¯´åˆ—è¡¨')
    await expect(page).toHaveURL('/novels')
    
    // 3. ç‚¹å‡»ä¸€éƒ¨å°è¯´
    await page.click('.novel-card:first-child')
    await expect(page.locator('h1')).toBeVisible()
    
    // 4. å°è¯•ç‚¹èµï¼ˆæœªç™»å½•åº”è·³è½¬ç™»å½•é¡µï¼‰
    await page.click('button[aria-label="ç‚¹èµ"]')
    await expect(page).toHaveURL('/login')
    
    // 5. ç‚¹å‡»æ³¨å†Œ
    await page.click('text=ç«‹å³æ³¨å†Œ')
    await expect(page).toHaveURL('/register')
    
    // 6. å¡«å†™æ³¨å†Œè¡¨å•
    await page.fill('input[name="email"]', 'test@example.com')
    await page.fill('input[name="username"]', 'testuser')
    await page.fill('input[name="password"]', 'Test123456')
    await page.click('button[type="submit"]')
    
    // 7. æ³¨å†ŒæˆåŠŸååº”è·³è½¬åˆ°é¦–é¡µ
    await expect(page).toHaveURL('/')
    await expect(page.locator('text=testuser')).toBeVisible()
    
    // 8. å†æ¬¡å°è¯•ç‚¹èµ
    await page.goto('/novels/1')
    await page.click('button[aria-label="ç‚¹èµ"]')
    await expect(page.locator('text=å·²ç‚¹èµ')).toBeVisible()
  })
  
  test('ä½œè€…å‘å¸ƒå°è¯´æµç¨‹', async ({ page }) => {
    // 1. ç™»å½•
    await page.goto('/login')
    await page.fill('input[name="email"]', 'author@test.com')
    await page.fill('input[name="password"]', 'password123')
    await page.click('button[type="submit"]')
    
    // 2. è¿›å…¥ç®¡ç†åå°
    await page.goto('/admin')
    await expect(page.locator('text=ä»ªè¡¨ç›˜')).toBeVisible()
    
    // 3. ç‚¹å‡»æ–°å»ºå°è¯´
    await page.click('text=æ–°å»ºå°è¯´')
    await expect(page).toHaveURL('/admin/novels/new')
    
    // 4. å¡«å†™å°è¯´ä¿¡æ¯
    await page.fill('input[name="title"]', 'E2Eæµ‹è¯•å°è¯´')
    await page.fill('textarea[name="summary"]', 'è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•å°è¯´çš„æ‘˜è¦')
    
    // 5. å¡«å†™å†…å®¹ï¼ˆå¯Œæ–‡æœ¬ç¼–è¾‘å™¨ï¼‰
    const editor = page.locator('.ProseMirror')
    await editor.click()
    await editor.fill('è¿™æ˜¯å°è¯´çš„æ­£æ–‡å†…å®¹...')
    
    // 6. é€‰æ‹©åˆ†ç±»
    await page.click('select[name="category"]')
    await page.click('option:has-text("ç„å¹»")')
    
    // 7. æ·»åŠ æ ‡ç­¾
    await page.fill('input[name="tags"]', 'ä¿®ä»™,çƒ­è¡€')
    
    // 8. ä¸Šä¼ å°é¢
    await page.setInputFiles('input[type="file"]', './test-cover.jpg')
    await expect(page.locator('img[alt="å°é¢é¢„è§ˆ"]')).toBeVisible()
    
    // 9. ä¿å­˜è‰ç¨¿
    await page.click('button:has-text("ä¿å­˜è‰ç¨¿")')
    await expect(page.locator('text=ä¿å­˜æˆåŠŸ')).toBeVisible()
    
    // 10. å‘å¸ƒå°è¯´
    await page.click('button:has-text("å‘å¸ƒ")')
    await expect(page.locator('text=å‘å¸ƒæˆåŠŸ')).toBeVisible()
    
    // 11. éªŒè¯å°è¯´å‡ºç°åœ¨åˆ—è¡¨ä¸­
    await page.goto('/novels')
    await expect(page.locator('text=E2Eæµ‹è¯•å°è¯´')).toBeVisible()
  })
  
  test('ç®¡ç†å‘˜ç®¡ç†ç”¨æˆ·æµç¨‹', async ({ page }) => {
    // 1. ç®¡ç†å‘˜ç™»å½•
    await page.goto('/login')
    await page.fill('input[name="email"]', 'admin@test.com')
    await page.fill('input[name="password"]', 'admin123')
    await page.click('button[type="submit"]')
    
    // 2. è¿›å…¥ç”¨æˆ·ç®¡ç†
    await page.goto('/admin/users')
    await expect(page.locator('text=ç”¨æˆ·ç®¡ç†')).toBeVisible()
    
    // 3. æœç´¢ç”¨æˆ·
    await page.fill('input[placeholder="æœç´¢ç”¨æˆ·"]', 'testuser')
    await page.press('input[placeholder="æœç´¢ç”¨æˆ·"]', 'Enter')
    
    // 4. æŸ¥çœ‹ç”¨æˆ·è¯¦æƒ…
    await page.click('.user-row:first-child')
    await expect(page.locator('text=ç”¨æˆ·è¯¦æƒ…')).toBeVisible()
    
    // 5. ä¿®æ”¹ç”¨æˆ·è§’è‰²
    await page.click('select[name="role"]')
    await page.click('option:has-text("ä½œè€…")')
    await page.click('button:has-text("ä¿å­˜")')
    
    // 6. éªŒè¯ä¿®æ”¹æˆåŠŸ
    await expect(page.locator('text=ä¿®æ”¹æˆåŠŸ')).toBeVisible()
  })
})

test.describe('ç§»åŠ¨ç«¯é€‚é…', () => {
  test.use({ viewport: { width: 375, height: 667 } }) // iPhone SE
  
  test('ç§»åŠ¨ç«¯æµè§ˆä½“éªŒ', async ({ page }) => {
    await page.goto('/')
    
    // 1. æ£€æŸ¥æ±‰å ¡èœå•
    await expect(page.locator('[aria-label="èœå•"]')).toBeVisible()
    
    // 2. æ‰“å¼€èœå•
    await page.click('[aria-label="èœå•"]')
    await expect(page.locator('.mobile-menu')).toBeVisible()
    
    // 3. æµè§ˆå°è¯´åˆ—è¡¨ï¼ˆç€‘å¸ƒæµåº”è¯¥æ˜¯2åˆ—ï¼‰
    await page.goto('/novels')
    const grid = page.locator('.novel-grid')
    await expect(grid).toHaveCSS('grid-template-columns', 'repeat(2, minmax(0, 1fr))')
    
    // 4. é˜…è¯»å™¨é€‚é…
    await page.goto('/novels/1/read')
    await expect(page.locator('.reader')).toBeVisible()
    
    // 5. å­—ä½“è°ƒèŠ‚æŒ‰é’®å¯è§
    await expect(page.locator('button[aria-label="å­—ä½“è®¾ç½®"]')).toBeVisible()
  })
})
```

**E2Eæµ‹è¯•åœºæ™¯æ¸…å•**:
```bash
[ ] ç”¨æˆ·æ³¨å†Œç™»å½•æµç¨‹
[ ] å°è¯´æµè§ˆå’Œé˜…è¯»æµç¨‹  
[ ] ç‚¹èµæ”¶è—è¯„è®ºæµç¨‹
[ ] ä½œè€…å‘å¸ƒå°è¯´æµç¨‹
[ ] ç®¡ç†å‘˜ç®¡ç†åå°æµç¨‹
[ ] æœç´¢åŠŸèƒ½æµç¨‹
[ ] ç§»åŠ¨ç«¯é€‚é…æµ‹è¯•
[ ] å¤šæµè§ˆå™¨å…¼å®¹æ€§æµ‹è¯•
```

---

## 6. æ€§èƒ½æµ‹è¯•è®¡åˆ’

### 6.1 Lighthouseæ€§èƒ½æµ‹è¯•

```bash
# lighthouse-test.sh
#!/bin/bash

echo "ğŸš€ å¼€å§‹Lighthouseæ€§èƒ½æµ‹è¯•..."

# é¦–é¡µ
lighthouse https://your-domain.com \
  --output=json \
  --output-path=./reports/homepage.json \
  --preset=desktop

# å°è¯´åˆ—è¡¨é¡µ
lighthouse https://your-domain.com/novels \
  --output=json \
  --output-path=./reports/novels-list.json

# å°è¯´è¯¦æƒ…é¡µ
lighthouse https://your-domain.com/novels/test-novel \
  --output=json \
  --output-path=./reports/novel-detail.json

echo "âœ… æµ‹è¯•å®Œæˆï¼ŒæŠ¥å‘Šå·²ä¿å­˜åˆ° reports/ ç›®å½•"
```

**æ€§èƒ½æŒ‡æ ‡è¦æ±‚**:
```
æŒ‡æ ‡          ç›®æ ‡      è­¦æˆ’çº¿
---------------------------------
Lighthouse   95+       90
LCP          < 1.5s    < 2.5s
FID          < 50ms    < 100ms
CLS          < 0.1     < 0.25
TTI          < 2.5s    < 3.5s
```

### 6.2 è´Ÿè½½æµ‹è¯•

ä½¿ç”¨ **K6** è¿›è¡Œå‹åŠ›æµ‹è¯•

```javascript
// k6-load-test.js
import http from 'k6/http'
import { check, sleep } from 'k6'
import { Rate } from 'k6/metrics'

const errorRate = new Rate('errors')

export const options = {
  stages: [
    { duration: '1m', target: 50 },   // é¢„çƒ­åˆ°50ç”¨æˆ·
    { duration: '3m', target: 100 },  // å¢åŠ åˆ°100ç”¨æˆ·
    { duration: '2m', target: 200 },  // å³°å€¼200ç”¨æˆ·
    { duration: '2m', target: 100 },  // é™å›100
    { duration: '1m', target: 0 },    // é™å›0
  ],
  thresholds: {
    http_req_duration: ['p(95)<500'],  // 95%è¯·æ±‚<500ms
    errors: ['rate<0.05'],             // é”™è¯¯ç‡<5%
  },
}

const BASE_URL = __ENV.BASE_URL || 'https://your-domain.com'

export default function () {
  // 1. è®¿é—®é¦–é¡µ
  let res = http.get(`${BASE_URL}/`)
  check(res, {
    'é¦–é¡µçŠ¶æ€200': (r) => r.status === 200,
    'é¦–é¡µåŠ è½½<1s': (r) => r.timings.duration < 1000,
  }) || errorRate.add(1)
  
  sleep(1)
  
  // 2. è®¿é—®å°è¯´åˆ—è¡¨
  res = http.get(`${BASE_URL}/api/novels`)
  check(res, {
    'APIçŠ¶æ€200': (r) => r.status === 200,
    'APIå“åº”<200ms': (r) => r.timings.duration < 200,
  }) || errorRate.add(1)
  
  sleep(2)
  
  // 3. è®¿é—®å°è¯´è¯¦æƒ…
  res = http.get(`${BASE_URL}/novels/test-novel`)
  check(res, {
    'è¯¦æƒ…é¡µçŠ¶æ€200': (r) => r.status === 200,
  }) || errorRate.add(1)
  
  sleep(3)
}
```

**è¿è¡Œæµ‹è¯•**:
```bash
k6 run k6-load-test.js
```

---

## 7. å®‰å…¨æµ‹è¯•æ¸…å•

```bash
[ ] SQLæ³¨å…¥æµ‹è¯•
    [ ] å°è¯´æœç´¢è¾“å…¥æ¡†
    [ ] ç”¨æˆ·ç™»å½•è¡¨å•
    [ ] è¯„è®ºè¾“å…¥æ¡†

[ ] XSSæ”»å‡»æµ‹è¯•
    [ ] å°è¯´æ ‡é¢˜è¾“å…¥
    [ ] è¯„è®ºå†…å®¹
    [ ] ç”¨æˆ·å/ç®€ä»‹

[ ] CSRFé˜²æŠ¤æµ‹è¯•
    [ ] ç™»å½•æ¥å£
    [ ] åˆ›å»ºå°è¯´æ¥å£
    [ ] åˆ é™¤æ“ä½œ

[ ] æƒé™æ§åˆ¶æµ‹è¯•
    [ ] æ™®é€šç”¨æˆ·ä¸èƒ½è®¿é—®ç®¡ç†åå°
    [ ] ä½œè€…åªèƒ½ç¼–è¾‘è‡ªå·±çš„å°è¯´
    [ ] æœªç™»å½•ç”¨æˆ·ä¸èƒ½ç‚¹èµæ”¶è—

[ ] æ•æ„Ÿæ•°æ®ä¿æŠ¤
    [ ] å¯†ç å·²åŠ å¯†å­˜å‚¨(bcrypt)
    [ ] APIè¿”å›ä¸åŒ…å«æ•æ„Ÿå­—æ®µ
    [ ] Sessionå®‰å…¨é…ç½®

[ ] Rate Limitingæµ‹è¯•
    [ ] APIé™æµç”Ÿæ•ˆ
    [ ] ç™»å½•å°è¯•æ¬¡æ•°é™åˆ¶
```

---

## 8. å…¼å®¹æ€§æµ‹è¯•çŸ©é˜µ

### 8.1 æµè§ˆå™¨å…¼å®¹æ€§

```
æµè§ˆå™¨          ç‰ˆæœ¬       ä¼˜å…ˆçº§    çŠ¶æ€
----------------------------------------------
Chrome         æœ€æ–°        P0       [ ]
Firefox        æœ€æ–°        P0       [ ]
Safari         æœ€æ–°        P0       [ ]
Edge           æœ€æ–°        P1       [ ]
Chrome Mobile  æœ€æ–°        P0       [ ]
Safari iOS     æœ€æ–°        P0       [ ]
```

### 8.2 è®¾å¤‡å…¼å®¹æ€§

```
è®¾å¤‡ç±»å‹         åˆ†è¾¨ç‡          ä¼˜å…ˆçº§    çŠ¶æ€
----------------------------------------------
Desktop         1920x1080        P0       [ ]
Laptop          1366x768         P0       [ ]
iPad Pro        1024x1366        P1       [ ]
iPad            768x1024         P1       [ ]
iPhone 14 Pro   393x852          P0       [ ]
iPhone SE       375x667          P1       [ ]
Android         360x640          P1       [ ]
```

---

## 9. æµ‹è¯•å·¥å…·å’Œç¯å¢ƒ

### 9.1 æµ‹è¯•å·¥å…·æ ˆ

```bash
# å®‰è£…æµ‹è¯•ä¾èµ–
pnpm add -D \
  vitest \
  @testing-library/react \
  @testing-library/jest-dom \
  @testing-library/user-event \
  @playwright/test \
  k6 \
  lighthouse
```

### 9.2 æµ‹è¯•ç¯å¢ƒé…ç½®

```
ç¯å¢ƒç±»å‹     URL                         æ•°æ®åº“
--------------------------------------------------------
å¼€å‘ç¯å¢ƒ     http://localhost:3000       æœ¬åœ°MySQL
æµ‹è¯•ç¯å¢ƒ     https://test.domain.com     æµ‹è¯•MySQL
é¢„å‘å¸ƒç¯å¢ƒ   https://staging.domain.com  é•œåƒç”Ÿäº§æ•°æ®
ç”Ÿäº§ç¯å¢ƒ     https://your-domain.com     ç”Ÿäº§MySQL
```

---

## 10. Bugç®¡ç†æµç¨‹

### 10.1 Bugä¸¥é‡æ€§ç­‰çº§

```
P0 - è‡´å‘½    ç³»ç»Ÿå´©æºƒã€æ•°æ®ä¸¢å¤±ã€å®‰å…¨æ¼æ´
P1 - ä¸¥é‡    æ ¸å¿ƒåŠŸèƒ½ä¸å¯ç”¨
P2 - ä¸€èˆ¬    æ¬¡è¦åŠŸèƒ½å¼‚å¸¸
P3 - è½»å¾®    UIæ˜¾ç¤ºé—®é¢˜ã€ä½“éªŒä¼˜åŒ–
```

### 10.2 Bugç”Ÿå‘½å‘¨æœŸ

```
[å‘ç°] â†’ [ç¡®è®¤] â†’ [åˆ†é…] â†’ [ä¿®å¤] â†’ [éªŒè¯] â†’ [å…³é—­]
```

### 10.3 BugæŠ¥å‘Šæ¨¡æ¿

```markdown
## Bugæ ‡é¢˜
ç®€çŸ­æè¿°é—®é¢˜

## ç¯å¢ƒä¿¡æ¯
- æµè§ˆå™¨: Chrome 120
- æ“ä½œç³»ç»Ÿ: Windows 11
- è®¾å¤‡: Desktop
- ç¯å¢ƒ: æµ‹è¯•ç¯å¢ƒ

## é‡ç°æ­¥éª¤
1. è®¿é—® /novels
2. ç‚¹å‡»ç¬¬ä¸€ä¸ªå°è¯´
3. ç‚¹å‡»"ç‚¹èµ"æŒ‰é’®

## é¢„æœŸç»“æœ
ç‚¹èµæ•°+1ï¼ŒæŒ‰é’®æ˜¾ç¤º"å·²ç‚¹èµ"

## å®é™…ç»“æœ
é¡µé¢æŠ¥é”™ï¼Œæ§åˆ¶å°æ˜¾ç¤º500é”™è¯¯

## æˆªå›¾/å½•å±
[é™„ä»¶]

## é”™è¯¯ä¿¡æ¯
```
Error: Failed to like novel
  at LikeButton.tsx:45
```

## ä¸¥é‡æ€§
P1 - ä¸¥é‡

## ä¼˜å…ˆçº§
é«˜
```

---

## 11. æµ‹è¯•æŠ¥å‘Šæ¨¡æ¿

### 11.1 æ¯æ—¥æµ‹è¯•æŠ¥å‘Š

```markdown
# æµ‹è¯•æ—¥æŠ¥ - 2025-10-26

## ä»Šæ—¥æµ‹è¯•è¿›åº¦
- å®Œæˆæµ‹è¯•ç”¨ä¾‹: 45/200
- å‘ç°Bug: 8ä¸ª (P0: 0, P1: 2, P2: 4, P3: 2)
- ä¿®å¤éªŒè¯: 5ä¸ª

## æµ‹è¯•è¦†ç›–
- å•å…ƒæµ‹è¯•: 45%
- é›†æˆæµ‹è¯•: 20%
- E2Eæµ‹è¯•: 0%

## é£é™©æç¤º
- å°è¯´åˆ—è¡¨APIæ€§èƒ½ä¸è¾¾æ ‡ï¼Œå“åº”æ—¶é—´300ms(ç›®æ ‡100ms)
- ç§»åŠ¨ç«¯é˜…è¯»å™¨æ ·å¼é”™ä¹±

## æ˜æ—¥è®¡åˆ’
- å®Œæˆå°è¯´æ¨¡å—æµ‹è¯•
- å¼€å§‹ç”¨æˆ·æ¨¡å—æµ‹è¯•
```

### 11.2 æœ€ç»ˆæµ‹è¯•æŠ¥å‘Š

```markdown
# é‡æ„é¡¹ç›®æµ‹è¯•æŠ¥å‘Š

## é¡¹ç›®ä¿¡æ¯
- é¡¹ç›®åç§°: å°è¯´å¹³å°é‡æ„
- æµ‹è¯•å‘¨æœŸ: 2025-10-20 ~ 2025-10-30
- æµ‹è¯•è´Ÿè´£äºº: å·¥ç¨‹å¸ˆE

## æµ‹è¯•ç»Ÿè®¡
- æ€»æµ‹è¯•ç”¨ä¾‹: 523
- æ‰§è¡Œç”¨ä¾‹: 520
- é€šè¿‡: 495
- å¤±è´¥: 25
- é€šè¿‡ç‡: 95.2%

## ä»£ç è¦†ç›–ç‡
- å•å…ƒæµ‹è¯•è¦†ç›–: 82%
- é›†æˆæµ‹è¯•è¦†ç›–: 78%
- E2Eæµ‹è¯•è¦†ç›–: 100%å…³é”®æµç¨‹

## Bugç»Ÿè®¡
- æ€»Bugæ•°: 47
- å·²ä¿®å¤: 43
- å¾…ä¿®å¤: 4 (P3çº§åˆ«)
- é—ç•™Bug: 1 (å·²è®°å½•)

## æ€§èƒ½æµ‹è¯•ç»“æœ
- Lighthouseå¾—åˆ†: 96
- LCP: 1.2s âœ…
- FID: 35ms âœ…
- CLS: 0.08 âœ…

## å…¼å®¹æ€§æµ‹è¯•
- Chrome: âœ… é€šè¿‡
- Firefox: âœ… é€šè¿‡
- Safari: âœ… é€šè¿‡
- Mobile: âœ… é€šè¿‡

## ä¸Šçº¿å»ºè®®
âœ… å»ºè®®ä¸Šçº¿ï¼Œé—ç•™é—®é¢˜å¯åœ¨åç»­è¿­ä»£ä¿®å¤
```

---

## 12. æµ‹è¯•æ—¶é—´è¡¨

```
Week 3: æµ‹è¯•å‡†å¤‡
â”œâ”€â”€ Day 1-2: æµ‹è¯•ç¯å¢ƒæ­å»º
â”œâ”€â”€ Day 3: ç¼–å†™æµ‹è¯•è®¡åˆ’
â”œâ”€â”€ Day 4-5: ç¼–å†™æµ‹è¯•ç”¨ä¾‹

Week 4: å•å…ƒ/é›†æˆæµ‹è¯•
â”œâ”€â”€ Day 1-2: åç«¯å•å…ƒæµ‹è¯•
â”œâ”€â”€ Day 3-4: å‰ç«¯ç»„ä»¶æµ‹è¯•
â””â”€â”€ Day 5: APIé›†æˆæµ‹è¯•

Week 5: E2E/æ€§èƒ½æµ‹è¯•
â”œâ”€â”€ Day 1-2: E2Eæµ‹è¯•
â”œâ”€â”€ Day 3: æ€§èƒ½æµ‹è¯•
â”œâ”€â”€ Day 4: å®‰å…¨æµ‹è¯•
â””â”€â”€ Day 5: å…¼å®¹æ€§æµ‹è¯•

Week 6: å›å½’æµ‹è¯•
â”œâ”€â”€ Day 1-2: Bugä¿®å¤éªŒè¯
â”œâ”€â”€ Day 3: å…¨é‡å›å½’æµ‹è¯•
â”œâ”€â”€ Day 4: ç”Ÿäº§ç¯å¢ƒéªŒè¯
â””â”€â”€ Day 5: æµ‹è¯•æŠ¥å‘Šè¾“å‡º
```

---

**æœ€åæ›´æ–°**: 2025-10-26  
**æ–‡æ¡£çŠ¶æ€**: âœ… å¿…é¡»æ‰§è¡Œ  
**å…³é”®ä¾èµ–**: éœ€è¦æ–°å¢å·¥ç¨‹å¸ˆE(QAæµ‹è¯•å·¥ç¨‹å¸ˆ)

